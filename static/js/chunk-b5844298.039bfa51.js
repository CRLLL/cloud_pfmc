(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b5844298"],{"3fbf":function(t,i,e){"use strict";e.r(i);var s=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("el-form",{ref:"distributionForm",attrs:{model:t.distributionForm,rules:t.rules,"label-width":"80px",disabled:!t.isEdit}},[e("el-row",[e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"名称",prop:"distribution.distributionName"}},[e("el-input",{model:{value:t.distributionForm.distribution.distributionName,callback:function(i){t.$set(t.distributionForm.distribution,"distributionName",i)},expression:"distributionForm.distribution.distributionName"}})],1)],1),t._v(" "),e("el-col",{attrs:{span:12}},[e("el-form-item",{attrs:{label:"状态",prop:"distribution.status"}},[e("el-select",{attrs:{placeholder:"状态",clearable:"",size:"small"},model:{value:t.distributionForm.distribution.status,callback:function(i){t.$set(t.distributionForm.distribution,"status",i)},expression:"distributionForm.distribution.status"}},t._l(t.statusOptions,(function(t){return e("el-option",{key:t.dictValue,attrs:{label:t.dictLabel,value:t.dictValue}})})),1)],1)],1)],1),t._v(" "),e("el-row",[e("el-col",{attrs:{span:24}},[e("el-form-item",{attrs:{label:"附件"}},[e("file-upload",{attrs:{"business-type":"pfmc-distrib","business-id":t.tmpBusinessId},on:{"update-business-id":t.updateBusinessId}})],1)],1)],1),t._v(" "),e("el-row",{staticClass:"button-float-right"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:t.handleAddRow}},[t._v("增加")]),t._v(" "),e("el-button",{attrs:{type:"danger",icon:"el-icon-remove",size:"mini",disabled:0==this.selectedRows.length},on:{click:function(i){return t.handleDelRow(t.selectedRows)}}},[t._v("删除")])],1),t._v(" "),e("el-table",{ref:"scaleTable",attrs:{data:t.distributionForm.items,"empty-text":" ",height:"300"},on:{"selection-change":t.selsChange}},[e("el-table-column",{attrs:{type:"selection",align:"center"}}),t._v(" "),e("el-table-column",{attrs:{label:"比例",align:"center"},scopedSlots:t._u([{key:"default",fn:function(i){return[e("el-form-item",{attrs:{prop:"items."+i.$index+".scale",rules:[{required:!0,message:"比例不能为空",trigger:"change"}]}},[e("el-row",[e("el-col",{attrs:{span:8}},[e("el-input",{staticClass:"light-blue-theme",attrs:{type:"text",minlength:"1",maxlength:"3"},nativeOn:{keyup:function(e){return t.numberValid(i.row)}},model:{value:i.row.scale,callback:function(e){t.$set(i.row,"scale",e)},expression:"scope.row.scale"}})],1),t._v(" "),e("el-col",{attrs:{span:2}},[t._v("%")])],1)],1)]}}])})],1)],1)},n=[],r=(e("ac6a"),e("a481"),{name:"DistributionDetail",components:{FileUpload:function(){return e.e("chunk-85cbf3cc").then(e.bind(null,"705e"))}},props:{isEdit:{type:Boolean,default:!1},distributionForm:{type:Object,default:function(){return{distribution:{distributionId:"0",distributionName:"",status:"1"},items:[{distributionItemId:"",distributionId:"",scale:"",orderNum:1,isDeleted:!1}]}}}},data:function(){return{title:"",statusOptions:[],selectedRows:[],rules:{"distribution.distributionName":[{required:!0,message:"正态分布名称不能为空",trigger:"blur"}],"distribution.status":[{required:!0,message:"状态不能为空",trigger:"change"}]},tmpBusinessId:""}},computed:{},watch:{distributionForm:function(t,i){this.$emit("update:distributionForm",this.distributionForm)},"distributionForm.distribution.distributionId":function(t,i){this.tmpBusinessId=t&&"0"!==t?t:""}},created:function(){var t=this;this.getDicts("sys_normal_status").then((function(i){t.statusOptions=i.data}))},mounted:function(){},methods:{updateBusinessId:function(t){t&&t.newBusinessId!==this.tmpBusinessId&&(this.tmpBusinessId=t.newBusinessId)},numberValid:function(t){t.scale=t.scale.replace(/[^\.\d]/g,"").replace(".","")},handleAddRow:function(){var t=this.distributionForm.items,i=0==t.length?1:parseInt(t[t.length-1].orderNum)+1;this.distributionForm.items.push({distributionItemId:"0",distributionId:this.distributionForm.distribution.distributionId,scale:"",orderNum:i,isDeleted:!1})},handleDelRow:function(t){var i=this,e=t;e&&e.forEach((function(t,e){i.distributionForm.items.forEach((function(e,s){t.orderNum===e.orderNum&&i.distributionForm.items.splice(s,1)}))})),this.$refs.scaleTable.clearSelection(),this.selectedRows=[]},selsChange:function(t){this.selectedRows=t},validateForm:function(){var t=this,i=!0;this.$refs.distributionForm.validate((function(t){i=t}));var e=this.distributionForm.items,s=0;return i&&e.every((function(i,n){return""===i.scale?(t.$message({showClose:!0,message:"比例不能为空"}),!1):(s+=parseInt(i.scale),e.length==n+1&&100!=s?(t.$message({showClose:!0,message:"比例总和不为100"}),!1):e.length==n+1&&100==s||void 0)}))},resetFormValidate:function(t){this.$refs["distributionForm"].resetFields()}}}),o=r,a=(e("8cfc"),e("2877")),u=Object(a["a"])(o,s,n,!1,null,"4e1b4f6c",null);i["default"]=u.exports},"8cfc":function(t,i,e){"use strict";var s=e("a270"),n=e.n(s);n.a},a270:function(t,i,e){}}]);