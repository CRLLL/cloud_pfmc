(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-31daa794","chunk-2d21062b","chunk-b5d27614","chunk-04bac318","chunk-142d866f","chunk-3a57c6ee","chunk-10db1c36","chunk-6b5bb127","chunk-2d21062b"],{2879:function(t,e,r){"use strict";r.r(e),r.d(e,"treeselect",(function(){return c})),r.d(e,"selectPfmcEmpList",(function(){return o})),r.d(e,"addPfmcOrg",(function(){return s})),r.d(e,"updatePfmcOrg",(function(){return i})),r.d(e,"delPfmcOrg",(function(){return l})),r.d(e,"searchEmp",(function(){return u})),r.d(e,"addEmpToOrg",(function(){return p})),r.d(e,"updatePfmcEmp",(function(){return d})),r.d(e,"delPfmcEmp",(function(){return m})),r.d(e,"batchTransferEmp",(function(){return f})),r.d(e,"listEmpNameOrNumber",(function(){return h})),r.d(e,"batchUpdateEmpStatus",(function(){return b})),r.d(e,"listEmp",(function(){return g})),r.d(e,"delOrgCheck",(function(){return v}));var a=r("b775"),n=r("b854");function c(){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/treeselect"),method:"get"})}function o(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/listEmpByOrgId"),method:"get",params:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp"),method:"post",data:t})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp"),method:"put",data:t})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/deleteOrg/").concat(t),method:"delete"})}function u(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/searchEmp"),method:"get",params:t})}function p(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/updateEmpOfOrg"),method:"get",params:t})}function d(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/updateEmp"),method:"post",data:t})}function m(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/deleteEmp/").concat(t),method:"delete"})}function f(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/batchTransferEmp"),method:"post",data:t})}function h(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/listEmpNameOrNumber"),method:"get",params:t})}function b(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/batchUpdateEmpStatus"),method:"post",data:t})}function g(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/listEmp"),method:"post",data:t})}function v(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/delOrgCheck/").concat(t),method:"delete"})}},"2f21":function(t,e,r){"use strict";var a=r("79e5");t.exports=function(t,e){return!!t&&a((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"304f":function(t,e,r){"use strict";r.r(e),r.d(e,"listPfmcCycle",(function(){return c})),r.d(e,"getPfmcCycle",(function(){return o})),r.d(e,"addPfmcCycle",(function(){return s})),r.d(e,"updatePfmcCycle",(function(){return i})),r.d(e,"batchAddPfmcCycle",(function(){return l}));var a=r("b775"),n=r("b854");function c(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/list"),method:"get",params:t})}function o(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/").concat(t),method:"get"})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/add"),method:"post",data:t})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/update"),method:"put",data:t})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/batchAdd"),method:"post",data:t})}},"4a47":function(t,e,r){"use strict";r.r(e),r.d(e,"listPfmcGroup",(function(){return c})),r.d(e,"addPfmcGroup",(function(){return o})),r.d(e,"getPfmcGroup",(function(){return s})),r.d(e,"updatePfmcGroup",(function(){return i})),r.d(e,"delPfmcGroup",(function(){return l})),r.d(e,"disablePfmcGroup",(function(){return u})),r.d(e,"changeGroupState",(function(){return p})),r.d(e,"listGroupUsers",(function(){return d}));var a=r("b775"),n=r("b854");function c(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/list"),method:"get",params:t})}function o(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup"),method:"post",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/").concat(t),method:"get"})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/update"),method:"put",data:t})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/").concat(t),method:"delete"})}function u(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/disablePfmcBaseGroup/").concat(t),method:"get"})}function p(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/changeGroupState"),method:"put",data:t})}function d(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/groupUsers"),method:"get",params:t})}},"542c":function(t,e,r){},"55dd":function(t,e,r){"use strict";var a=r("5ca1"),n=r("d8e8"),c=r("4bf8"),o=r("79e5"),s=[].sort,i=[1,2,3];a(a.P+a.F*(o((function(){i.sort(void 0)}))||!o((function(){i.sort(null)}))||!r("2f21")(s)),"Array",{sort:function(t){return void 0===t?s.call(c(this)):s.call(c(this),n(t))}})},"688f":function(t,e,r){},7514:function(t,e,r){"use strict";var a=r("5ca1"),n=r("0a49")(5),c="find",o=!0;c in[]&&Array(1)[c]((function(){o=!1})),a(a.P+a.F*o,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(c)},a552:function(t,e,r){"use strict";var a=r("688f"),n=r.n(a);n.a},b854:function(t,e,r){"use strict";r.r(e),r.d(e,"pfmcSettings",(function(){return a})),r.d(e,"pfmcAsist",(function(){return n})),r.d(e,"pfmcExecution",(function(){return c})),r.d(e,"pfmcEval",(function(){return o}));var a="pfmc-settings",n="pfmc-asist",c="pfmc-execution",o="pfmc-eval"},c7cb:function(t,e,r){"use strict";r.r(e),r.d(e,"listEmp",(function(){return c})),r.d(e,"batchStartEmpEval",(function(){return o})),r.d(e,"batchStartEmpEvalWithGrade",(function(){return s})),r.d(e,"listGradeAssessor",(function(){return i}));var a=r("b775"),n=r("b854");function c(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/startEmpEval/listEmp"),method:"post",data:t})}function o(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/startEmpEval/batchStartEmpEval"),method:"post",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/startEmpEval/batchStartEmpEvalWithGrade"),method:"post",data:t})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/startEmpEval/listGradeAssessor"),method:"post",data:t})}},f400:function(t,e,r){"use strict";var a=r("c26b"),n=r("b39a"),c="Map";t.exports=r("e0b8")(c,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=a.getEntry(n(this,c),t);return e&&e.v},set:function(t,e){return a.def(n(this,c),0===t?0:t,e)}},a,!0)},ffd2:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"ihr-wrapper"},[r("div",{staticClass:"top-query"},[r("el-form",{attrs:{model:t.queryParams,"label-width":"80px"}},[r("el-row",[r("el-col",[r("el-form-item",{attrs:{"label-width":"0px"}},[r("el-radio-group",{model:{value:t.queryParams.searchMode,callback:function(e){t.$set(t.queryParams,"searchMode",e)},expression:"queryParams.searchMode"}},[r("el-radio-button",{attrs:{label:"DEPT"}},[t._v("按部门查询")]),t._v(" "),r("el-radio-button",{attrs:{label:"GROUP"}},[t._v("按考核组查询")])],1)],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"年份",prop:"year",rules:{required:!0}}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,type:"year"},on:{change:t.getCycleList},model:{value:t.queryParams.year,callback:function(e){t.$set(t.queryParams,"year",e)},expression:"queryParams.year"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"考核周期",prop:"periodId",rules:{required:!0}}},[r("el-select",{attrs:{placeholder:"请选择..."},on:{change:function(e){return t.getGroupList()}},model:{value:t.queryParams.periodId,callback:function(e){t.$set(t.queryParams,"periodId",e)},expression:"queryParams.periodId"}},t._l(t.periodOptions,(function(t){return r("el-option",{key:t.cycleId,attrs:{label:t.cycleName,value:t.cycleId}})})),1)],1)],1),t._v(" "),r("el-col",{attrs:{span:9}},["DEPT"===t.queryParams.searchMode?r("el-form-item",{attrs:{label:"部门",prop:"deptIds",rules:{required:!0}}},[r("tree-select",{staticClass:"dept-tree-select",attrs:{options:t.deptOptions,multiple:"",placeholder:"请选择...","default-expand-level":1},model:{value:t.queryParams.deptIds,callback:function(e){t.$set(t.queryParams,"deptIds",e)},expression:"queryParams.deptIds"}})],1):r("el-form-item",{attrs:{label:"考核组",prop:"groupIds",rules:{required:!0}}},[r("el-select",{attrs:{placeholder:"请选择...",multiple:"",clearable:""},model:{value:t.queryParams.groupIds,callback:function(e){t.$set(t.queryParams,"groupIds",e)},expression:"queryParams.groupIds"}},t._l(t.groupOptions,(function(t){return r("el-option",{key:t.groupId,attrs:{label:t.groupName,value:t.groupId}})})),1)],1)],1)],1)],1),t._v(" "),r("div",[r("el-button",{attrs:{type:"primary",name:"DEPT"===t.queryParams.searchMode?"searchByDept":"searchByGroup",icon:"el-icon-search"},on:{click:function(e){return t.handleQuery()}}},[t._v("查询")])],1)],1),t._v(" "),r("div",{staticClass:"main-table"},[r("div",{staticClass:"button-flex"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-caret-right",disabled:0===t.selectedEmpList.length},on:{click:t.handleStartEmpEval}},[t._v("启动考核")])],1),t._v(" "),r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{attrs:{label:"查询结果"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"searchTabel",attrs:{data:t.searchEmpList,"row-key":function(t){return t.objectId},"select-on-indeterminate":!1,"row-class-name":t.tableRowClassName},on:{"select-all":t.selsAll,select:t.trigSelect}},[t._v("\n          >\n          "),r("el-table-column",{attrs:{type:"selection",selectable:t.selectAble}}),t._v(" "),r("el-table-column",{attrs:{label:"员工编号",prop:"empNumber","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"empName","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"部门",prop:"orgName","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"职位",prop:"positionName","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"考核打分人",prop:"evalers",width:"300px"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",[t._v(t._s(e.row.evalers))]),t._v(" "),r("el-button",{attrs:{type:"primary",plain:"",circle:"",size:"mini",icon:"el-icon-edit"},on:{click:function(r){return t.handleEditRelation(e.row)}}})]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"考核状态",prop:"evalStatus","show-overflow-tooltip":!0,formatter:t.evalStatusFormat}}),t._v(" "),r("el-table-column",{attrs:{label:"不参加考核原因",prop:"noevalReason",width:"120","show-overflow-tooltip":!0}})],1),t._v(" "),r("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],staticClass:"pagination-wrap",attrs:{total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:function(e){return t.handleQuery()}}})],1),t._v(" "),r("el-tab-pane",{attrs:{label:"已选中员工"+t.selectedEmpList.length+"人"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.selectedEmpList}},[r("el-table-column",{attrs:{label:"员工编号",prop:"empNumber","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"empName","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"部门",prop:"orgName","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"职位",prop:"positionName","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"考核打分人",prop:"evalers",width:"300","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"考核状态",prop:"evalStatus",formatter:t.evalStatusFormat,"show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"不参加考核原因",prop:"noevalReason",width:"120","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"90",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClearSel(e.row)}}},[t._v("删除")])]}}])})],1)],1)],1)],1),t._v(" "),r("edit-relation",{attrs:{visible:t.isEditRelation,title:t.EditRelationTitle,"relation-id":t.relationId,"is-update":t.isUpdateRelation},on:{"update:visible":function(e){t.isEditRelation=e}}})],1)},n=[],c=(r("55dd"),r("7514"),r("5df3"),r("f400"),r("ac6a"),r("542c"),r("2879")),o=r("304f"),s=r("4a47"),i=r("c7cb"),l={components:{TreeSelect:function(){return r.e("chunk-5c5c1f08").then(r.t.bind(null,"7026",7))},editRelation:function(){return r.e("chunk-34efd14e").then(r.bind(null,"2dd3"))}},data:function(){return{queryParams:{year:new Date,periodId:void 0,deptIds:[],groupIds:[],searchMode:"DEPT",pageNum:1,pageSize:10},loading:!1,periodOptions:[],deptOptions:[],groupOptions:[],searchEmpList:[],total:0,selectedEmpList:[],currPagePreSelected:[],prePageSelected:[],isEditRelation:!1,EditRelationTitle:"编辑考核关系",relationId:void 0,isUpdateRelation:!0}},created:function(){this.getCycleList(),this.getTreeselect()},mounted:function(){},methods:{handleStartEmpEval:function(){var t=this;if(0!==this.selectedEmpList.length){var e="";if(this.selectedEmpList.forEach((function(t){t.evalers||0!==t.leaderCnt[0]||(e=e+t.empName+",")})),e)this.msgInfo(e.substring(0,e.length-1)+"没有考核关系且没有部门领导");else{var r=this.selectedEmpList.map((function(t){return{empId:t.objectId,planId:t.planId}})),a={periodId:this.queryParams.periodId,empEvalList:r};this.loading=!0,Object(i["batchStartEmpEval"])(a).then((function(e){t.loading=!1,"0"===e.code?(t.msgSuccess("正在后台发起员工考核"),t.selectedEmpList=[]):t.msgError(e.msg)})).catch((function(e){t.loading=!1,t.msgError(e)}))}}else this.msgInfo("请选择员工")},handleQuery:function(){this.queryParams.periodId?"DEPT"!==this.queryParams.searchMode||0!==this.queryParams.deptIds.length?"GROUP"!==this.queryParams.searchMode||0!==this.queryParams.groupIds.length?this.getEmpList(this.queryParams):this.msgInfo("请选择考核组"):this.msgInfo("请选择部门"):this.msgInfo("请选择考核周期")},evalStatusFormat:function(t,e){switch(t.evalStatus){case"NO_CREATED":return"计划未制定";case"PLAN_CREATED":return"计划制定";case"PLAN_FINISHED":return"计划完成";case"SELF_EVALUATE":return"自评打分";case"MAN_AUDITEVAL":return"领导打分";case"EVAL_FINISHED":return"考核完成";default:return""}},getEmpList:function(t){var e=this;this.loading=!0,Object(i["listEmp"])(t).then((function(t){e.loading=!1,"0"===t.code?(e.total=t.data.total,e.searchEmpList=t.data.list,e.$nextTick((function(){var t=this;this.currPagePreSelected=[],this.searchEmpList.forEach((function(e,r){t.selectedEmpList.forEach((function(r,a){e.objectId===r.objectId&&(r.evalers=e.evalers,t.currPagePreSelected.push(e),t.$refs.searchTabel.toggleRowSelection(e,!0))}))}))}))):e.msgError(t.msg)})).catch((function(t){e.loading=!1,e.msgError(t)}))},selsChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.length>this.currPagePreSelected.length?this.selectedEmpList=this.addSels(this.selectedEmpList,t):t.length>0&&0!==e.length?this.selectedEmpList=this.delUnSels(this.selectedEmpList,e):0===t.length&&(this.selectedEmpList=this.delUnSels(this.selectedEmpList,this.currPagePreSelected)),this.currPagePreSelected=t},addSels:function(t,e){var r=t.concat(e),a=new Map;r.forEach((function(t){return a.set(t.objectId,t)}));var n=new Array;return a.forEach((function(t,e){n.push(t)})),n},delUnSels:function(t,e){return e.forEach((function(e,r){t.forEach((function(r,a){e.objectId===r.objectId&&t.splice(a,1)}))})),t},trigSelect:function(t,e){this.selsChange(t,[e])},selsAll:function(t){var e=this,r=[],a=[];t.forEach((function(t){"undefined"===typeof t.noevalReason?r.push(t):a.push(t)})),a.forEach((function(t){return e.$refs.searchTabel.toggleRowSelection(t,!1)})),this.selsChange(r)},selectAble:function(t,e){return"PLAN_FINISHED"===t.evalStatus},handleClearSel:function(t){var e=this;this.selectedEmpList.forEach((function(r,a){r.objectId===t.objectId&&e.selectedEmpList.splice(a,1)})),this.searchEmpList.forEach((function(r,a){r.objectId===t.objectId&&e.$refs.searchTabel.toggleRowSelection(t,!1)}))},handleEditRelation:function(t){t.relationId?(this.isEditRelation=!0,this.isUpdateRelation=!0,this.relationId=t.relationId):(this.isEditRelation=!0,this.isUpdateRelation=!1,this.relationId="0")},getTreeselect:function(){var t=this;Object(c["treeselect"])().then((function(e){t.deptOptions=e.data}))},getCycleList:function(){var t=this,e={cycleYear:this.queryParams.year.getFullYear(),pageNum:1,pageSize:0};Object(o["listPfmcCycle"])(e).then((function(e){"0"===e.code?t.periodOptions=t.cycleSort(e.data.list):t.msgError("查询考核周期列表失败")})).catch((function(e){t.msgError(e)}))},getGroupList:function(){var t=this,e=this.periodOptions.find((function(e){return e.cycleId==t.queryParams.periodId})),r={groupPeriodType:e?e.cycleType:"",groupState:1,pageNum:1,pageSize:0};Object(s["listPfmcGroup"])(r).then((function(e){"0"===e.code?t.groupOptions=e.data.list:t.msgError("查询考核组列表失败")})).catch((function(e){t.msgError(e)}))},cycleCompare:function(t,e){var r=t.cycleTypeOrder,a=e.cycleTypeOrder,n=t.startDate,c=e.startDate;return r>a||r<a?r>a?1:-1:r==a?n>c?1:n==c?0:-1:void 0},cycleSort:function(t){var e=t.map((function(t){switch(t.cycleType){case"month_pfmc":t.cycleTypeOrder=1;break;case"quarter_pfmc":t.cycleTypeOrder=2;break;case"half_year_pfmc":t.cycleTypeOrder=3;break;case"year_pfmc":t.cycleTypeOrder=4;break;default:t.cycleTypeOrder=5;break}return t}));return e.sort(this.cycleCompare)},tableRowClassName:function(t){var e=t.row;t.rowIndex;return"undefined"!==typeof e.noevalReason?"warning-row":""}},computed:{},watch:{isEditRelation:function(t,e){t||this.handleQuery()}}},u=l,p=(r("a552"),r("2877")),d=Object(p["a"])(u,a,n,!1,null,"68fbc36e",null);e["default"]=d.exports}}]);