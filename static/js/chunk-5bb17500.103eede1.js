(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5bb17500","chunk-b5d27614","chunk-2d216217"],{1696:function(t,e,r){"use strict";var o=r("83f3"),i=r.n(o);i.a},"2f21":function(t,e,r){"use strict";var o=r("79e5");t.exports=function(t,e){return!!t&&o((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"55dd":function(t,e,r){"use strict";var o=r("5ca1"),i=r("d8e8"),n=r("4bf8"),a=r("79e5"),l=[].sort,s=[1,2,3];o(o.P+o.F*(a((function(){s.sort(void 0)}))||!a((function(){s.sort(null)}))||!r("2f21")(l)),"Array",{sort:function(t){return void 0===t?l.call(n(this)):l.call(n(this),i(t))}})},"81c7":function(t,e,r){"use strict";r.r(e),r.d(e,"listFormSet",(function(){return n})),r.d(e,"addFormSet",(function(){return a})),r.d(e,"getformSet",(function(){return l})),r.d(e,"updateFormSet",(function(){return s})),r.d(e,"delFormSet",(function(){return c})),r.d(e,"disableFormSet",(function(){return d})),r.d(e,"progListByFormId",(function(){return u}));var o=r("b775"),i=r("b854");function n(t){return Object(o["a"])({url:"".concat(i["pfmcSettings"],"/pfmcPresetFormSet/list"),method:"get",params:t})}function a(t){return Object(o["a"])({url:"".concat(i["pfmcSettings"],"/pfmcPresetFormSet"),method:"post",data:t})}function l(t){return Object(o["a"])({url:"".concat(i["pfmcSettings"],"/pfmcPresetFormSet/").concat(t),method:"get"})}function s(t){return Object(o["a"])({url:"".concat(i["pfmcSettings"],"/pfmcPresetFormSet"),method:"put",data:t})}function c(t){return Object(o["a"])({url:"".concat(i["pfmcSettings"],"/pfmcPresetFormSet/").concat(t),method:"delete"})}function d(t){return Object(o["a"])({url:"".concat(i["pfmcSettings"],"/pfmcPresetFormSet/disableFormSet/").concat(t),method:"get"})}function u(t){return Object(o["a"])({url:"".concat(i["pfmcSettings"],"/pfmcPresetFormSet/getProgByFormId/").concat(t),method:"get"})}},"83f3":function(t,e,r){},9494:function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus"},on:{click:t.handleSetFixItem}},[t._v("分配固定指标")]),t._v(" "),r("el-dialog",{ref:"previewContain",attrs:{visible:t.showDialog,title:t.title,width:"870px","append-to-body":""},on:{"update:visible":function(e){t.showDialog=e},close:t.resetForm}},[[r("el-collapse",{staticStyle:{width:"800px","border-bottom":"1"},model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},t._l(t.itemSectionList,(function(e,o){return r("el-collapse-item",{key:e.formSectionId,attrs:{name:o}},[r("template",{slot:"title"},[r("div",{staticStyle:{width:"100%"},on:{click:function(t){}}},[r("div",{staticStyle:{float:"left","margin-top":"13px",width:"150px","font-weight":"bold"}},[t._v(t._s(e.sectionName))]),t._v(" "),r("div",{staticStyle:{float:"right","margin-left":"10px","margin-top":"15px",width:"250px"}},[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},nativeOn:{click:function(r){return r.stopPropagation(),t.addItemRow(e,o)}}},[t._v("新增固定指标")])],1)])]),t._v(" "),r("div",{staticStyle:{width:"95%"}},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"row-key":t.getRowKeys,"expand-row-keys":t.expands},on:{"current-change":t.toggleRowExpansion}},[t._v("\n                :tree-props=\"{children: 'children', hasChildren: 'hasChildren'}\"\n                empty-text=\" \"\n              >\n                "),t._l(e.itemFieldList,(function(e,o){return t.isShowColumn(e)?r("el-table-column",{key:o,attrs:{prop:e.prop,width:e.width,label:e.fieldName,"show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(o){return["select"===e.fieldType?r("div",[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:o.row[e.prop],callback:function(r){t.$set(o.row,e.prop,r)},expression:"scope.row[item.prop]"}},t._l(e.selectValue,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1):"date"===e.fieldType?r("div",[r("el-date-picker",{staticStyle:{width:"100%",height:"100%","line-height":"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:o.row[e.prop],callback:function(r){t.$set(o.row,e.prop,r)},expression:"scope.row[item.prop]"}})],1):r("div",[r("el-input",{staticStyle:{width:"100%",height:"100%","line-height":"100%"},attrs:{type:"textarea"},model:{value:o.row[e.prop],callback:function(r){t.$set(o.row,e.prop,r)},expression:"scope.row[item.prop]"}})],1)]}}],null,!0)}):t._e()})),t._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center",width:"80","class-name":"small-padding fixed-width"},scopedSlots:t._u([{key:"default",fn:function(o){return[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:menu:remove"],expression:"['system:menu:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.handleDelRow(o.$index,e)}}})],1)]}}],null,!0)}),t._v(" "),0==t.widthPerIsShow?r("el-table-column",{attrs:{type:"expand"},scopedSlots:t._u([{key:"default",fn:function(o){return[r("el-form",{staticClass:"demo-table-expand",attrs:{"label-position":"left",inline:""}},[t._l(e.expendFieldList,(function(e,i){return[r("el-row",[t.isShowColumn(e)?r("el-form-item",{attrs:{label:e.fieldName,prop:e.prop}},["select"===e.fieldType?r("div",[r("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:o.row[e.prop],callback:function(r){t.$set(o.row,e.prop,r)},expression:"props.row[item.prop]"}},t._l(e.selectValue,(function(t){return r("el-option",{key:t,attrs:{label:t,value:t}})})),1)],1):"date"===e.fieldType?r("div",[r("el-date-picker",{staticStyle:{width:"100%",height:"100%","line-height":"100%"},attrs:{type:"date",placeholder:"选择日期"},model:{value:o.row[e.prop],callback:function(r){t.$set(o.row,e.prop,r)},expression:"props.row[item.prop]"}})],1):r("div",[r("el-input",{staticStyle:{width:"100%",height:"100%","line-height":"100%"},attrs:{type:"textarea"},model:{value:o.row[e.prop],callback:function(r){t.$set(o.row,e.prop,r)},expression:"props.row[item.prop]"}})],1)]):t._e()],1)]}))],2)]}}],null,!0)}):t._e()],2)],1)],2)})),1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{plain:"",icon:"el-icon-close"},on:{click:t.resetForm}},[t._v("取消")]),t._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-bank-card"},on:{click:t.submitForm}},[t._v("保存")])],1)]],2)],1)},i=[],n=(r("55dd"),r("28a5"),r("7f7f"),r("c0c7"),r("a5fd"),r("51a2")),a=r("81c7"),l={name:"viewPfmcForm",components:{},props:{visible:{type:Boolean,default:!1},size:{type:String,default:"mini"},type:{type:String,default:"primary"},plain:{type:Boolean,default:!0},round:{type:Boolean,default:!1},circle:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},icon:{type:String,default:""},btnText:{type:String,default:"预览表单"},title:{type:String,default:"预览表单"},progId:{type:String,default:""},fixedProgrel:{type:Object,default:function(){return{}}}},data:function(){return{widthPerIsShow:!0,showDialog:!1,loading:!0,formSetSectionList:[],itemSectionList:[],expands:[],activeNames:[]}},created:function(){},mounted:function(){},computed:{},methods:{resetForm:function(){this.itemSectionList=[],this.showDialog=!1},toggleRowExpansion:function(t){this.expands=[],this.expands.push(t.rowId)},getRowKeys:function(t){return t.rowId},isShowColumn:function(t){return t.viewStage<2},handleSetFixItem:function(){this.progId?(this.showPfmcTable(),this.title="分配固定指标",this.showDialog=!0):this.msgError("请先选择考核方案！")},addItemRow:function(t,e){for(var r={},o=0;o<t.itemFieldList.length;o++){var i=t.itemFieldList[o],n=i.prop;r[n]=""}for(var a=0;a<t.expendFieldList.length;a++){var l=t.expendFieldList[a],s=l.prop;r[s]=""}t.tableData||(t.tableData=[]),t.tableData.push(r)},sortNumber:function(t,e){return parseInt(t.showOrder)-parseInt(e.showOrder)},getCurItem:function(t,e,r){for(var o=null,i=0;t&&i<t.length;i++){var n=t[i];if(n[r]===e){o=n;break}}return o},buildTableTitle:function(t,e,r){var o=[],i=[],n={titleFields:o,expendFields:i};if(e){for(var a=0;a<t.formSetFieldList.length;a++){var l=t.formSetFieldList[a],s={fieldName:l.fieldName,showOrder:l.showOrder,prop:l.formFieldId,fieldType:l.fieldType,viewStage:parseInt(l.viewStage),selectValue:"select"===l.fieldType?l.selectValue.split(","):[],width:"1"==t.widthPerType?r*parseInt(l.widthper)/100+"px":l.widthper+"px"};o.push(s)}o.sort(this.sortNumber)}else for(var c=0;c<t.formSetFieldList.length;c++){var d=t.formSetFieldList[c],u={fieldName:d.fieldName,showOrder:d.showOrder,prop:"5"===d.otherAttr?d.empId:d.formFieldId,fieldType:d.fieldType,viewStage:parseInt(d.viewStage),selectValue:"select"===d.fieldType?d.selectValue.split(","):[],width:"1"==t.widthPerType?r*parseInt(d.widthper)/100+"px":d.widthper+"px",otherAttr:d.otherAttr};"2"==d.otherAttr?(u.width=.2*r+"px",o.push(u)):"3"==d.otherAttr?(u.width=.1*r+"px",o.push(u)):"4"==d.otherAttr?(u.width=.2*r+"px",o.push(u)):"5"==d.otherAttr?(u.width=.2*r+"px",o.push(u)):i.push(u),o.sort(this.sortNumber),i.sort(this.sortNumber)}return n},buildHorizontalData:function(t,e){for(var r=[],o=0;t&&o<t.length;o++){var i=t[o];if(i.formSectionId==e.formSectionId){for(var n=i?i.pfmcFixedItems:null,a={},l=!1,s=0;s<e.formSetFieldList.length;s++){var c=e.formSetFieldList[s],d=this.getCurItem(n,c.formFieldId,"formFieldId");d&&(a[c.formFieldId]=d.itemValue,l=!0)}l&&r.push(a)}}return r},buildItemList:function(t,e,r,o){var i=[];if(t&&0!=t.length){for(var n=0;n<t.length;n++){var a=t[n],l={sectionName:a.sectionName,formSectionId:a.formSectionId,showOrder:a.showOrder,itemFieldList:[],expendFieldList:[],tableData:[]};if(!a.formSetFieldList||0==a.formSetFieldList.length)break;var s=this.buildTableTitle(a,o,r);l.itemFieldList=s.titleFields,l.expendFieldList=s.expendFields,l.tableData=this.buildHorizontalData(e,a),i.push(l),i.sort(this.sortNumber),this.activeNames.push(n)}return i}},showPfmcTable:function(){var t=this;this.progId&&(this.loading=!0,Object(n["getProgram"])(this.progId).then((function(e){var r=e.data;Object(a["getformSet"])(r.formId).then((function(e){t.formSetSectionList=e.data.formSetSectionList,t.widthPerIsShow="1"===e.data.showType;var r=t.$refs.previewContain.width;t.itemSectionList=t.buildItemList(t.formSetSectionList,t.fixedProgrel?t.fixedProgrel.pfmcFixedItemRows:null,r,t.widthPerIsShow)||[],t.loading=!1}))})))},handleDelRow:function(t,e){e.tableData.splice(t,1)},submitForm:function(){for(var t={moduleId:this.progId,pfmcFixedItemRows:[]},e=0;e<this.itemSectionList.length;e++)for(var r=this.itemSectionList[e],o=0;o<r.tableData.length;o++){var i=r.tableData[o],n={formSectionId:r.formSectionId,pfmcFixedItems:[]};for(var a in i){var l={formFieldId:a,itemValue:i[a]};n.pfmcFixedItems.push(l)}t.pfmcFixedItemRows.push(n)}this.$emit("handleSave",t),this.resetForm()}},watch:{}},s=l,c=(r("1696"),r("2877")),d=Object(c["a"])(s,o,i,!1,null,"27ec73b8",null);e["default"]=d.exports},c0c7:function(t,e,r){"use strict";r.d(e,"h",(function(){return n})),r.d(e,"f",(function(){return a})),r.d(e,"a",(function(){return l})),r.d(e,"k",(function(){return s})),r.d(e,"e",(function(){return c})),r.d(e,"j",(function(){return d})),r.d(e,"d",(function(){return u})),r.d(e,"g",(function(){return p})),r.d(e,"l",(function(){return f})),r.d(e,"m",(function(){return m})),r.d(e,"n",(function(){return h})),r.d(e,"i",(function(){return w})),r.d(e,"c",(function(){return b})),r.d(e,"b",(function(){return v}));var o=r("b775"),i=r("365c");function n(t){return Object(o["a"])({url:"".concat(i["d"],"/user/list"),method:"get",params:t})}function a(t){return Object(o["a"])({url:"".concat(i["d"],"/user/").concat(t),method:"get"})}function l(t){return Object(o["a"])({url:"".concat(i["d"],"/user"),method:"post",data:t})}function s(t){return Object(o["a"])({url:"".concat(i["d"],"/user"),method:"put",data:t})}function c(t){return Object(o["a"])({url:"".concat(i["d"],"/user/").concat(t),method:"delete"})}function d(t,e){var r={userId:t,password:e};return Object(o["a"])({url:"".concat(i["d"],"/user/resetPwd"),method:"put",data:r})}function u(t,e){var r={userId:t,status:e};return Object(o["a"])({url:"".concat(i["d"],"/user/changeStatus"),method:"put",data:r})}function p(){return Object(o["a"])({url:"".concat(i["d"],"/user/profile"),method:"get"})}function f(t){return Object(o["a"])({url:"".concat(i["d"],"/user/profile"),method:"put",data:t})}function m(t,e){var r={oldPassword:t,newPassword:e};return Object(o["a"])({url:"".concat(i["d"],"/user/profile/updatePwd"),method:"put",params:r})}function h(t){return Object(o["a"])({url:"".concat(i["d"],"/user/profile/avatar"),method:"post",data:t})}function w(t){return Object(o["a"])({url:"".concat(i["d"],"/user/listUserRole"),method:"get",params:t})}function b(t){return Object(o["a"])({url:"".concat(i["d"],"/user/batchSaveUserRole"),method:"post",data:t})}function v(t){return Object(o["a"])({url:"".concat(i["d"],"/user/batchDeleteUserRole"),method:"put",data:t})}}}]);