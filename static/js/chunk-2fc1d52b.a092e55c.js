(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2fc1d52b"],{"7ae5":function(e,t,n){"use strict";var r=n("d31e"),a=n.n(r);a.a},b51e:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("el-form",{attrs:{inline:!0}},[n("el-form-item",{attrs:{label:"模型名称"}},[n("el-input",{attrs:{placeholder:"请输入模型名称",clearable:"",size:"small"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.KEYWORDS,callback:function(t){e.$set(e.queryParams,"KEYWORDS",t)},expression:"queryParams.KEYWORDS"}})],1),e._v(" "),n("el-form-item",{attrs:{label:"部署时间"}},[n("el-date-picker",{staticStyle:{width:"240px"},attrs:{size:"small","value-format":"yyyy-MM-dd",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}})],1),e._v(" "),n("el-form-item",[n("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"mini"},on:{click:e.handleQuery}},[e._v("搜索")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"mini"},on:{click:e.handleImport}},[e._v("导入流程")]),e._v(" "),n("el-button",{attrs:{type:"primary",icon:"el-icon-delete",size:"mini"},on:{click:e.handleDeleteAll}},[e._v("删除")])],1)],1),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.workflowList,"row-key":"DEPLOYMENT_ID_"},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"50"}}),e._v(" "),n("el-table-column",{attrs:{label:"#",align:"center",type:"index",width:"50"}}),e._v(" "),n("el-table-column",{attrs:{prop:"NAME_",label:"流程名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"KEY_",label:"流程定义KEY"}}),e._v(" "),n("el-table-column",{attrs:{prop:"VERSION_",label:"版本",width:"60"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v("v."+e._s(t.row.VERSION_))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"DEPLOY_TIME_",label:"部署时间",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",[e._v(e._s(e.dateFormat(t.row.DEPLOY_TIME_)))])]}}])}),e._v(" "),n("el-table-column",{attrs:{prop:"RESOURCE_NAME_",label:"流程bpmn文件名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"DGRM_RESOURCE_NAME_",label:"\t流程图片名称"}}),e._v(" "),n("el-table-column",{attrs:{prop:"SUSPENSION_STATE_",label:"状态",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[1===t.row.SUSPENSION_STATE_?n("font",{attrs:{color:"#87B87F"}},[e._v("已激活")]):n("font",{attrs:{color:"red"}},[e._v("已挂起")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"映射模型",placement:"top"}},[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-copy-document"},on:{click:function(n){return e.handleModel(t.row)}}})],1),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"打包下载",placement:"top"}},[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-download"},on:{click:function(n){return e.handelExport(t.row)}}})],1),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:1===t.row.SUSPENSION_STATE_?"挂起":"激活",placement:"top"}},[n("el-button",{attrs:{size:"mini",type:"text",icon:1===t.row.SUSPENSION_STATE_?"el-icon-video-pause":"el-icon-video-play"},on:{click:function(n){return e.handleState(t.row)}}})],1),e._v(" "),n("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top"}},[n("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(n){return e.handleDelete(t.row)}}})],1)]}}])})],1),e._v(" "),n("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],attrs:{total:e.total,page:e.queryParams.currentPage,limit:e.queryParams.showCount},on:{"update:page":function(t){return e.$set(e.queryParams,"currentPage",t)},"update:limit":function(t){return e.$set(e.queryParams,"showCount",t)},pagination:e.getList}}),e._v(" "),n("el-dialog",{attrs:{id:"uploadDialog",title:"导入流程",visible:e.uploadShow},on:{"update:visible":function(t){e.uploadShow=t}}},[n("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[n("el-form-item",{attrs:{label:"模型文件",prop:"modelfile"}},[n("div",{staticClass:"costs-uploadfile-div"},[n("input",{attrs:{type:"file",id:"fileField"},on:{change:function(t){return e.checkFileType()}}}),e._v(" "),n("input",{attrs:{type:"text",id:"textfield",value:"请选择zip格式的压缩包"}})])])],1),e._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.submitForm}},[e._v("确 定")]),e._v(" "),n("el-button",{on:{click:e.cancel}},[e._v("取 消")])],1)],1)],1)},a=[],o=(n("ac6a"),n("96cf"),n("3b8d")),i=n("b775"),s=n("365c");function l(e){return Object(i["a"])({url:"".concat(s["a"],"/procdef/list"),method:"get",params:e})}function c(e){return Object(i["a"])({url:"".concat(s["a"],"/procdef/delete?DEPLOYMENT_ID_=").concat(e),method:"delete"})}function u(e){return Object(i["a"])({url:"".concat(s["a"],"/procdef/deleteAll?DATA_IDS=").concat(e),method:"delete"})}function d(){var e="".concat(window.location.origin).concat("http://114.251.247.98/api");return new Promise((function(t){t(e)}))}function p(e){return Object(i["a"])({url:"".concat(s["a"],"/fhmodel/saveModelFromPro?processDefinitionId=").concat(e),method:"get"})}function m(e,t){return Object(i["a"])({url:"".concat(s["a"],"/procdef/onoffPro?ID_=").concat(e,"&STATUS=").concat(t),method:"get"})}function f(e){return Object(i["a"])({url:"".concat(s["a"],"/procdef/uploadPro"),method:"post",data:e})}var h={data:function(){return{loading:!1,multipleSelection:[],total:0,queryParams:{KEYWORDS:void 0,currentPage:1,showCount:10},dateRange:[],workflowList:[],uploadShow:!1,form:{},rules:{}}},created:function(){this.getList()},methods:{getList:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,this.loading=!0,e.next=4,l(this.addDateRange(this.queryParams,this.dateRange));case 4:t=e.sent,this.loading=!1,"success"===t.result&&(this.workflowList=t.varList,this.total=t.page.totalResult),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),this.loading=!1,this.msgError(e.t0.message);case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}(),handleDelete:function(e){var t=this;this.$confirm('是否确认删除名称为"'+e.NAME_+'"的数据项?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return c(e.DEPLOYMENT_ID_)})).then((function(){t.getList(),t.msgSuccess("删除成功")})).catch((function(){}))},handelExport:function(e){this.$confirm('是否确认下载名称为"'+e.NAME_+'"的模型文件?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,d();case 2:n=t.sent,window.location.href="".concat(n,"/march-activiti/procdef/download?DEPLOYMENT_ID_=").concat(e.DEPLOYMENT_ID_);case 4:case"end":return t.stop()}}),t)}))))},handleImport:function(){this.uploadShow=!0},checkFileType:function(){var e=document.getElementById("fileField").value,t=e.substr(e.lastIndexOf(".")).toLowerCase();".zip"!=t?(this.$message.error("请上传zip格式的压缩包"),document.getElementById("fileField").value="",document.getElementById("textfield").value="请选择zip格式的压缩包"):document.getElementById("textfield").value=e},cancel:function(){this.uploadShow=!1,document.getElementById("fileField").value="",document.getElementById("textfield").value="请选择zip格式的压缩包"},submitForm:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=document.getElementById("fileField").value,""!==t){e.next=5;break}this.$message.error("请选择压缩包"),e.next=12;break;case 5:return n=new FormData,r=document.getElementById("fileField").files[0],n.append("zip",r),e.next=10,f(n);case 10:a=e.sent,"success"===a.result?(this.$message.success("上传成功"),this.uploadShow=!1,this.getList()):"error"===a.result?this.$message.error("导入失败! 文件资源不符合流程标准( 或缺少 xml or png )或者压缩包中包含目录"):"exception"===a.result&&this.$message.error("导入模版"+a.exception);case 12:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),handleState:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,1!==t.SUSPENSION_STATE_){e.next=8;break}return e.next=4,m(t.ID_,2);case 4:n=e.sent,"success"===n.result?(this.$message.success("挂起成功"),this.getList()):this.$message.error("挂起失败"),e.next=12;break;case 8:return e.next=10,m(t.ID_,1);case 10:r=e.sent,"success"===r.result?(this.$message.success("激活成功"),this.getList()):this.$message.error("激活失败");case 12:e.next=17;break;case 14:e.prev=14,e.t0=e["catch"](0),this.msgError(e.t0.message);case 17:case"end":return e.stop()}}),e,this,[[0,14]])})));function t(t){return e.apply(this,arguments)}return t}(),handleQuery:function(){this.queryParams.pageNum=1,this.getList()},handleModel:function(e){var t=this;p(e.ID_).then((function(e){"success"===e.result?t.$message.success("映射成功，可以去模型列表查看"):t.$message.error("映射失败")}))},handleSelectionChange:function(e){this.multipleSelection=e},handleDeleteAll:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:0===this.multipleSelection.length&&(this.msgError("请选择一条数据"),retutn),n=this,this.$confirm("确定要删除选中的数据吗?","删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){n.batchDelCode()})).catch((function(e){this.msgError(e)}));case 3:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),batchDelCode:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,t=[],this.multipleSelection.forEach((function(e){t.push(e.DEPLOYMENT_ID_)})),e.next=5,u(t);case 5:n=e.sent,"success"===n.result?(this.msgSuccess("删除成功"),this.getList()):this.msgError(n.msg),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),this.msgError(e.t0.message);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}()}},g=h,v=(n("7ae5"),n("2877")),_=Object(v["a"])(g,r,a,!1,null,"2fbff39a",null);t["default"]=_.exports},d31e:function(e,t,n){}}]);