(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c475d8d2","chunk-2d21062b","chunk-142d866f","chunk-6b5d1009","chunk-2d21062b"],{"304f":function(e,t,r){"use strict";r.r(t),r.d(t,"listPfmcCycle",(function(){return c})),r.d(t,"getPfmcCycle",(function(){return a})),r.d(t,"addPfmcCycle",(function(){return i})),r.d(t,"updatePfmcCycle",(function(){return l})),r.d(t,"batchAddPfmcCycle",(function(){return d}));var o=r("b775"),n=r("b854");function c(e){return Object(o["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/list"),method:"get",params:e})}function a(e){return Object(o["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/").concat(e),method:"get"})}function i(e){return Object(o["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/add"),method:"post",data:e})}function l(e){return Object(o["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/update"),method:"put",data:e})}function d(e){return Object(o["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/batchAdd"),method:"post",data:e})}},8966:function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"ihr-wrapper"},[r("div",{staticClass:"top-query"},[r("el-form",{ref:"gradeForm",attrs:{model:e.gradeForm,inline:!0}},[r("el-form-item",{attrs:{label:"年份",prop:"year"}},[r("el-date-picker",{attrs:{clearable:!1,type:"year"},on:{change:e.getCycleList},model:{value:e.gradeForm.year,callback:function(t){e.$set(e.gradeForm,"year",t)},expression:"gradeForm.year"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"考核周期",prop:"periodId"}},[r("el-select",{attrs:{placeholder:"请选择..."},model:{value:e.gradeForm.periodId,callback:function(t){e.$set(e.gradeForm,"periodId",t)},expression:"gradeForm.periodId"}},e._l(e.periodOptions,(function(e){return r("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycleId}})})),1)],1)],1),e._v(" "),r("div",[r("import-data",{attrs:{"task-id":"pfmc_execution_emp_grade",params:{periodId:e.gradeForm.periodId},returnFromServer:!0,btnText:"上传等级",disabled:"undefined"===typeof e.gradeForm.periodId},on:{"import-finished":e.importFinished}})],1)],1),e._v(" "),r("div",{staticClass:"main-table"},[r("div",{staticClass:"button-flex"},[r("el-button",{attrs:{type:"primary",icon:"el-icon-caret-right",disabled:0===e.gradeList.length},on:{click:e.launchFlow}},[e._v("启动流程")])],1),e._v(" "),r("el-table",{attrs:{data:e.gradeList,"row-key":"empId"}},[r("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),r("el-table-column",{attrs:{label:"员工编号",prop:"empNumber"}}),e._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"empName"}}),e._v(" "),r("el-table-column",{attrs:{label:"组织",prop:"orgName"}}),e._v(" "),r("el-table-column",{attrs:{label:"职位",prop:"position"}}),e._v(" "),r("el-table-column",{attrs:{label:"得分"},scopedSlots:e._u([{key:"default",fn:function(t){return[null!==t.row.score&&"undefined"!==typeof t.row.score?[e._v(e._s(t.row.score))]:[r("el-input",{on:{input:function(e){t.row.importScore=t.row.importScore.replace(/[^\d.]/g,"")}},model:{value:t.row.importScore,callback:function(r){e.$set(t.row,"importScore",r)},expression:"scope.row.importScore"}})]]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"等级"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-input",{model:{value:t.row.importGrade,callback:function(r){e.$set(t.row,"importGrade",r)},expression:"scope.row.importGrade"}})]}}])})],1)],1)])},n=[],c=(r("a481"),r("304f")),a=r("f957"),i={components:{ImportData:function(){return r.e("chunk-a7c7fc38").then(r.bind(null,"77dc"))}},props:{},data:function(){return{gradeList:[],gradeForm:{year:new Date,periodId:void 0},periodOptions:[]}},created:function(){this.getCycleList()},methods:{launchFlow:function(){var e=this;this.$confirm("确定发起员工绩效等级汇总上报流程？","提示").then((function(){if(e.dataValid()){var t={empGradeList:e.gradeList,periodId:e.gradeList[0].periodId},r=e.fullScreenLoading("正在发起流程，请稍后……");Object(a["startEmpGradeReport"])(t).then((function(t){r.close(),"0"===t.code?e.msgSuccess("流程发起成功"):e.msgError(t.msg)})).catch((function(t){r.close(),e.msgError(t)}))}}))},dataValid:function(){if(0===this.gradeList.length)return this.msgInfo("请先导入员工绩效等级信息"),!1;for(var e=0;e<this.gradeList.length;e++){var t=this.gradeList[e];if(null===t.score&&""===t.importScore)return this.msgInfo(t.empName+"的得分不能为空，请修改"),!1;if(!t.importGrade)return this.msgInfo(t.empName+"的等级不能为空，请修改"),!1}return!0},importFinished:function(e){e.flag&&(this.gradeList=e.respData)},scoreFormat:function(e){e.score},gradeFormat:function(e){},numberValid:function(e){e.importScore=e.importScore.replace(/[^\.\d]/g,"").replace(".","")},getCycleList:function(){var e=this,t={cycleYear:this.gradeForm.year.getFullYear(),pageNum:1,pageSize:0};Object(c["listPfmcCycle"])(t).then((function(t){"0"===t.code?e.periodOptions=t.data.list:e.msgError("查询考核周期列表失败")})).catch((function(t){e.msgError(t)}))}},watch:{}},l=i,d=r("2877"),u=Object(d["a"])(l,o,n,!1,null,"df5dc762",null);t["default"]=u.exports},b854:function(e,t,r){"use strict";r.r(t),r.d(t,"pfmcSettings",(function(){return o})),r.d(t,"pfmcAsist",(function(){return n})),r.d(t,"pfmcExecution",(function(){return c})),r.d(t,"pfmcEval",(function(){return a}));var o="pfmc-settings",n="pfmc-asist",c="pfmc-execution",a="pfmc-eval"},f957:function(e,t,r){"use strict";r.r(t),r.d(t,"startEmpGradeReport",(function(){return c})),r.d(t,"getFlowInofByPid",(function(){return a})),r.d(t,"flowApproval",(function(){return i})),r.d(t,"saveDraft",(function(){return l}));var o=r("b775"),n=r("b854");function c(e){return Object(o["a"])({url:"".concat(n["pfmcExecution"],"/empGradeReport/startEmpGradeReport"),method:"post",data:e})}function a(e){return Object(o["a"])({url:"".concat(n["pfmcExecution"],"/empGradeReport/getFlowInofByPid/").concat(e),method:"get"})}function i(e){return Object(o["a"])({url:"".concat(n["pfmcExecution"],"/empGradeReport/flowApproval"),method:"post",data:e})}function l(e){return Object(o["a"])({url:"".concat(n["pfmcExecution"],"/empGradeReport/saveDraft"),method:"post",data:e})}}}]);