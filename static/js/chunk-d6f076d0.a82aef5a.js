(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-d6f076d0","chunk-2d21062b","chunk-142d866f","chunk-6b5b9531","chunk-2d21062b","chunk-2d22d460"],{"304f":function(e,t,a){"use strict";a.r(t),a.d(t,"listPfmcCycle",(function(){return l})),a.d(t,"getPfmcCycle",(function(){return o})),a.d(t,"addPfmcCycle",(function(){return s})),a.d(t,"updatePfmcCycle",(function(){return i})),a.d(t,"batchAddPfmcCycle",(function(){return c}));var n=a("b775"),r=a("b854");function l(e){return Object(n["a"])({url:"".concat(r["pfmcSettings"],"/pfmccycle/list"),method:"get",params:e})}function o(e){return Object(n["a"])({url:"".concat(r["pfmcSettings"],"/pfmccycle/").concat(e),method:"get"})}function s(e){return Object(n["a"])({url:"".concat(r["pfmcSettings"],"/pfmccycle/add"),method:"post",data:e})}function i(e){return Object(n["a"])({url:"".concat(r["pfmcSettings"],"/pfmccycle/update"),method:"put",data:e})}function c(e){return Object(n["a"])({url:"".concat(r["pfmcSettings"],"/pfmccycle/batchAdd"),method:"post",data:e})}},"864e":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"ihr-wrapper"},[a("div",{staticClass:"top-query"},[a("el-form",{ref:"queryForm",attrs:{model:e.queryParams,"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"年份",prop:"year"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,type:"year"},on:{change:e.getCycleList},model:{value:e.queryParams.year,callback:function(t){e.$set(e.queryParams,"year",t)},expression:"queryParams.year"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"考核周期",prop:"periodId"}},[a("el-select",{attrs:{placeholder:"请选择..."},model:{value:e.queryParams.periodId,callback:function(t){e.$set(e.queryParams,"periodId",t)},expression:"queryParams.periodId"}},e._l(e.periodOptions,(function(e){return a("el-option",{key:e.cycleId,attrs:{label:e.cycleName,value:e.cycleId}})})),1)],1)],1),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"数据来源",prop:"fromType"}},[a("el-select",{attrs:{placeholder:"请选择..."},model:{value:e.queryParams.fromType,callback:function(t){e.$set(e.queryParams,"fromType",t)},expression:"queryParams.fromType"}},e._l(e.fromTypedOptions,(function(e){return a("el-option",{key:e.fromTypeId,attrs:{label:e.fromTypeValue,value:e.fromTypeId}})})),1)],1)],1)],1)],1),e._v(" "),a("div",[a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")]),e._v(" "),a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh-left"},on:{click:e.handleReset}},[e._v("重置")])],1)],1),e._v(" "),a("div",{staticClass:"main-table"},[a("div",{staticClass:"button-flex"},[a("export-data",{attrs:{"task-id":"pfmc_execution_evalresult",params:e.exportResultParams,"before-download":e.handleExport,disabled:0==this.total,"btn-text":e.btnText}}),e._v(" "),a("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-download",disabled:0===this.selectList.length},on:{click:e.handleExportDetail}},[e._v("导出详细")])],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.evalResultList,"row-key":"procInstId"},on:{"select-all":e.selectAll,select:e.selectSingle}},[a("el-table-column",{attrs:{type:"selection",fixed:"left"}}),e._v(" "),a("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),a("el-table-column",{attrs:{label:"考核周期",prop:"cycleName","min-width":"100","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"员工编号",prop:"empNumber",width:"120","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"姓名",prop:"empName",width:"100","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"部门",prop:"orgName","min-width":"100","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"职位",prop:"positionName",width:"100","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"数据来源",prop:"fromType",width:"80","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"分数",prop:"score",width:"80","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"等级",prop:"grade",width:"80","show-overflow-tooltip":!0}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",width:"120",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticStyle:{"min-height":"36px"}},[a("view-eval-detail",{attrs:{type:"text",procInstId:t.row.procInstId,"btn-text":e.scanBtnText}})],1)]}}])})],1),e._v(" "),a("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],staticClass:"pagination-wrap",attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1)])},r=[],l=(a("ac6a"),a("5df3"),a("4f7f"),a("75fc")),o=a("f792"),s=a("c16e"),i=a("304f"),c={components:{ViewEvalDetail:function(){return Promise.all([a.e("chunk-0632e125"),a.e("chunk-b5d27614")]).then(a.bind(null,"e70b"))},ExportData:function(){return a.e("chunk-643642b6").then(a.bind(null,"2ee5"))}},data:function(){return{loading:!1,total:0,title:"",btnText:"导出结果",scanBtnText:"查看",scorePublishScan:"",gradePublishScan:"",periodOptions:[],deptOptions:[],evalResultList:[],selectList:[],queryParams:{ifEvalManage:"0",year:new Date,periodId:void 0,searchMode:"self"},exportResultParams:{},fromTypedOptions:[{fromTypeId:"eval",fromTypeValue:"绩效考核"}]}},created:function(){this.getCycleList(),this.getEvalParams()},methods:{getCycleList:function(){var e=this,t={cycleYear:""===this.queryParams.year?"":this.queryParams.year.getFullYear(),pageNum:1,pageSize:0};Object(i["listPfmcCycle"])(t).then((function(t){"0"===t.code?e.periodOptions=t.data.list:e.msgError("查询考核周期列表失败")})).catch((function(t){e.msgError(t)}))},getEvalParams:function(){var e=this;Object(s["selectEvalParams"])().then((function(t){e.scorePublishScan=t.data.scorePublishScan,e.gradePublishScan=t.data.gradePublishScan}))},handleReset:function(){this.resetForm("queryForm")},getList:function(){var e=this;this.loading=!0;var t={ifEvalManage:this.queryParams.ifEvalManage,year:""===this.queryParams?"":this.queryParams.year.getFullYear(),periodId:this.queryParams.periodId,searchMode:this.queryParams.searchMode,scorePublishScan:this.scorePublishScan,gradePublishScan:this.gradePublishScan,pageNum:1,pageSize:10};Object(s["listPfmcEvalResult"])(t).then((function(t){e.evalResultList=t.data.list,e.total=t.data.total,e.loading=!1}))},handleExport:function(){return this.exportResultParams={ifEvalManage:this.queryParams.ifEvalManage,year:""===this.queryParams?"":this.queryParams.year.getFullYear(),searchMode:this.queryParams.searchMode,periodId:this.queryParams.periodId,scorePublishScan:this.scorePublishScan,gradePublishScan:this.gradePublishScan},!(this.total<=0)||(this.msgInfo("没有结果，无需导出"),!1)},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},handleExportDetail:function(){var e=this,t=this.selectList.map((function(e){return{procInstId:e.procInstId,fromType:e.fromType}})),a={evalInfo:t};this.loading=!0,Object(s["exportDetail"])(a).then((function(t){e.loading=!1;var a=!t.headers["pfmc-file-download-error"]&&t.headers["pfmc-file-download-success"];if(a)Object(o["saveFile"])(t.data,t.headers["content-disposition"],t.headers["content-type"]);else{var n=t.headers["pfmc-file-download-error"]||"";e.$notify.error({title:"服务调用异常",message:n})}})).catch((function(t){e.loading=!1,e.$notify.error({title:"网络错误",message:t.message})})).finally((function(){e.loading=!1}))},addSels:function(e,t){e.push.apply(e,Object(l["a"])(t));var a=new Set;return e.reduce((function(e,t){return!a.has(t.procInstId)&&(a.add(t.procInstId)&&e.push(t)),e}),[])},delUnSels:function(e,t){return e.filter((function(e){return t.every((function(t){return t.procInstId!==e.procInstId}))}))},selectSingle:function(e,t){e.some((function(e){return e.procInstId===t.procInstId}))?this.selectList=this.addSels(this.selectList,[t]):this.selectList=this.delUnSels(this.selectList,[t])},selectAll:function(e){0===e.length?this.selectList=this.delUnSels(this.selectList,this.resultList):this.selectList=this.addSels(this.selectList,e)},handleScan:function(e){this.flowOpen=!0,this.flowParams.PROC_INST_ID_=e.procInstId}},watch:{open:function(){0==this.open&&this.getList()},publishOpen:function(){0==this.open&&this.getList()}}},u=c,d=a("2877"),p=Object(d["a"])(u,n,r,!1,null,null,null);t["default"]=p.exports},b854:function(e,t,a){"use strict";a.r(t),a.d(t,"pfmcSettings",(function(){return n})),a.d(t,"pfmcAsist",(function(){return r})),a.d(t,"pfmcExecution",(function(){return l})),a.d(t,"pfmcEval",(function(){return o}));var n="pfmc-settings",r="pfmc-asist",l="pfmc-execution",o="pfmc-eval"},c16e:function(e,t,a){"use strict";a.r(t),a.d(t,"listPfmcEvalResult",(function(){return l})),a.d(t,"checkEvalManageRole",(function(){return o})),a.d(t,"selectEvalParams",(function(){return s})),a.d(t,"exportDetail",(function(){return i})),a.d(t,"batchPublish",(function(){return c})),a.d(t,"publishResult",(function(){return u}));var n=a("b775"),r=a("b854");function l(e){return Object(n["a"])({url:"".concat(r["pfmcExecution"],"/pfmcEvalResult/listResult"),method:"post",data:e})}function o(){return Object(n["a"])({url:"".concat(r["pfmcExecution"],"/pfmcEvalResult/checkEvalManageRole"),method:"get"})}function s(){return Object(n["a"])({url:"".concat(r["pfmcExecution"],"/pfmcEvalResult/selectEvalParams"),method:"get"})}function i(e){return Object(n["a"])({url:"".concat(r["pfmcExecution"],"/pfmcEvalResultExport/exportEvalForm"),method:"post",data:e,responseType:"blob"})}function c(e){return Object(n["a"])({url:"".concat(r["pfmcExecution"],"/pfmcEvalResult/batchPublishEvalResult"),method:"post",data:e})}function u(e){return Object(n["a"])({url:"".concat(r["pfmcExecution"],"/pfmcEvalResult/publishEvalResult"),method:"post",data:e})}},f792:function(e,t,a){"use strict";a.r(t),a.d(t,"saveFile",(function(){return l}));var n=a("7618");function r(e,t,a){if(null==e)return"";var l="",o=Object(n["a"])(e);if("string"==o||"number"==o||"boolean"==o)l+="&"+t+"="+(null==a||a?encodeURIComponent(e):e);else for(var s in e){var i=null==t?s:t+(e instanceof Array?"["+s+"]":"."+s);l+=r(e[s],i,a)}return l}var l=function(e,t,a){var n=new Blob([e],{type:a}),r=decodeURIComponent(t.substring(29));if(window.navigator.msSaveOrOpenBlob)window.navigator.msSaveBlob(n,r);else{var l=document.createElement("a"),o=window.URL.createObjectURL(n);l.href=o,l.download=r,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(o),document.body.removeChild(l)}};t["default"]={urlEncode:r,saveFile:l}}}]);