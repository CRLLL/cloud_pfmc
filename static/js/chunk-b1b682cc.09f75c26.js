(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b1b682cc","chunk-2d21062b","chunk-71cbd0ca","chunk-34efd14e","chunk-142d866f","chunk-3a57c6ee","chunk-10db1c36","chunk-cf58091e","chunk-bb07ed0a","chunk-6b5ac146","chunk-2d21062b"],{"07ec":function(t,e,r){},2879:function(t,e,r){"use strict";r.r(e),r.d(e,"treeselect",(function(){return o})),r.d(e,"selectPfmcEmpList",(function(){return c})),r.d(e,"addPfmcOrg",(function(){return l})),r.d(e,"updatePfmcOrg",(function(){return i})),r.d(e,"delPfmcOrg",(function(){return s})),r.d(e,"searchEmp",(function(){return u})),r.d(e,"addEmpToOrg",(function(){return p})),r.d(e,"updatePfmcEmp",(function(){return m})),r.d(e,"delPfmcEmp",(function(){return d})),r.d(e,"batchTransferEmp",(function(){return f})),r.d(e,"listEmpNameOrNumber",(function(){return h})),r.d(e,"batchUpdateEmpStatus",(function(){return g})),r.d(e,"listEmp",(function(){return b})),r.d(e,"delOrgCheck",(function(){return v}));var a=r("b775"),n=r("b854");function o(){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/treeselect"),method:"get"})}function c(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/listEmpByOrgId"),method:"get",params:t})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp"),method:"post",data:t})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp"),method:"put",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/deleteOrg/").concat(t),method:"delete"})}function u(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/searchEmp"),method:"get",params:t})}function p(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/updateEmpOfOrg"),method:"get",params:t})}function m(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/updateEmp"),method:"post",data:t})}function d(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/deleteEmp/").concat(t),method:"delete"})}function f(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/batchTransferEmp"),method:"post",data:t})}function h(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/listEmpNameOrNumber"),method:"get",params:t})}function g(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/batchUpdateEmpStatus"),method:"post",data:t})}function b(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/listEmp"),method:"post",data:t})}function v(t){return Object(a["a"])({url:"".concat(n["pfmcAsist"],"/pfmcOrgEmp/delOrgCheck/").concat(t),method:"delete"})}},"2dd3":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-row",{staticClass:"app-container"},[r("el-dialog",{attrs:{title:t.title,visible:t.show,width:"980px","close-on-click-modal":!1},on:{"update:visible":function(e){t.show=e},open:t.open,close:t.cancel}},[r("el-form",{ref:"relationForm",attrs:{inline:!0,model:t.form,rules:t.rules,"label-width":"88px"}},[r("el-form-item",{attrs:{label:"年份",prop:"year"}},[r("el-date-picker",{ref:"yearPicker",attrs:{type:"year",placeholder:"请选择年份",width:"4px",disabled:t.isUpdate},on:{change:t.getCycleList},model:{value:t.form.year,callback:function(e){t.$set(t.form,"year",e)},expression:"form.year"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"考核周期",prop:"cycleId"}},[r("el-select",{attrs:{placeholder:"选择考核周期",disabled:t.isUpdate},model:{value:t.form.cycleId,callback:function(e){t.$set(t.form,"cycleId",e)},expression:"form.cycleId"}},t._l(t.cycleOptions,(function(t){return r("el-option",{key:t.cycleId,attrs:{label:t.cycleName,value:t.cycleId}})})),1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:9}},[r("div",[r("div",{staticClass:"table-top"},[r("el-row",[r("span",[t._v("被考核人列表")]),t._v(" "),!1===t.isUpdate?r("select-emp",{staticClass:"fr",attrs:{plain:"",icon:"el-icon-plus",btnText:"新增"},on:{"select-finish":t.handleSelectEmp}}):t._e()],1)],1),t._v(" "),r("el-table",{ref:"empTable",attrs:{data:t.form.relationVOList,"row-key":"personId","empty-text":"请查询员工",height:"300px"}},[r("el-table-column",{attrs:{label:"部门",prop:"deptName",width:"121","show-overflow-tooltip":!0}}),t._v(" "),r("el-table-column",{attrs:{label:"员工编号",prop:"empNumber",width:"91"}}),t._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"empName",width:"91"}}),t._v(" "),!1===t.isUpdate?r("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.deleteRow(e.$index,t.form.relationVOList)}}})],1)]}}],null,!1,38030880)}):t._e()],1),t._v(" "),r("pagination",{directives:[{name:"show",rawName:"v-show",value:t.empTotal>0,expression:"empTotal>0"}],attrs:{total:t.empTotal,small:"",layout:"sizes, prev, pager, next"}})],1)]),t._v(" "),r("el-col",{attrs:{span:1}},[r("div",{staticStyle:{width:"5px"}},[t._v(" ")])]),t._v(" "),r("el-col",{attrs:{span:13}},[r("div",[r("div",{staticClass:"table-top"},[r("el-row",[r("span",[t._v("考核人列表")]),t._v(" "),r("select-emp",{staticClass:"fr",attrs:{plain:"",icon:"el-icon-plus",btnText:"新增"},on:{"select-finish":t.handleSelectEvalPer}})],1)],1),t._v(" "),r("el-table",{ref:"empTable",attrs:{data:t.form.evalPersonVOList,"row-key":"personId","empty-text":"请查询员工",height:"300px"}},[r("el-table-column",{attrs:{label:"员工编号",prop:"empNumber",width:"120"}}),t._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"empName",width:"100"}}),t._v(" "),r("el-table-column",{attrs:{label:"权重",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-form-item",{staticStyle:{"margin-bottom":"0px"},attrs:{prop:"evalPersonVOList."+e.$index+".weight",rules:t.rules.weight}},[r("el-input",{attrs:{type:"number",min:0,max:100},model:{value:e.row.weight,callback:function(r){t.$set(e.row,"weight",t._n(r))},expression:"scope.row.weight"}})],1)]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"审批顺序",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("span",{staticStyle:{"margin-right":"5px"}},[t._v(t._s(e.row.orderNumber))]),t._v(" "),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"上移",placement:"top",enterable:!1}},[r("el-button",{attrs:{type:"text",icon:"el-icon-upload2"},on:{click:function(r){return r.stopPropagation(),t.moveUpTable(e.$index,e.row,t.form.evalPersonVOList)}}})],1),t._v(" "),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"下移",placement:"top",enterable:!1}},[r("el-button",{staticStyle:{"margin-left":"0"},attrs:{type:"text",icon:"el-icon-download"},on:{click:function(r){return r.stopPropagation(),t.moveDownTable(e.$index,e.row,t.form.evalPersonVOList)}}})],1)]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"目标审核",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-checkbox",{model:{value:e.row.targetFlag,callback:function(r){t.$set(e.row,"targetFlag",r)},expression:"scope.row.targetFlag"}})]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"考核打分",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-checkbox",{model:{value:e.row.scoreFlag,callback:function(r){t.$set(e.row,"scoreFlag",r)},expression:"scope.row.scoreFlag"}})]}}])}),t._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center","class-name":"small-padding fixed-width",width:"50"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[r("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(r){return t.deleteRow(e.$index,t.form.evalPersonVOList)}}})],1)]}}])})],1),t._v(" "),r("pagination",{directives:[{name:"show",rawName:"v-show",value:t.evalPerTotal>0,expression:"evalPerTotal>0"}],attrs:{total:t.evalPerTotal,small:"",layout:"sizes, prev, pager, next"}})],1)])],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{attrs:{plain:"",icon:"el-icon-close"},on:{click:t.cancel}},[t._v("取消")]),t._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-bank-card"},on:{click:t.submitForm}},[t._v("保存")])],1)],1)],1)},n=[],o=(r("c5f6"),r("ac6a"),r("e31f")),c=r("304f"),l={components:{SelectEmp:function(){return Promise.all([r.e("chunk-5c5c1f08"),r.e("chunk-457809e8")]).then(r.bind(null,"2cc9"))}},props:{visible:{type:Boolean,default:!1},isUpdate:{type:Boolean,default:!1},title:{type:String,default:""},queryYear:{type:Date,default:function(){return new Date}},queryCycleId:{type:String,default:""},relationId:{type:String,default:"0"}},data:function(){return{show:!1,year:new Date,empTotal:0,evalPerTotal:0,cycleOptions:[],form:{year:void 0,cycleId:void 0,cycleList:[],relationVOList:[],evalPersonVOList:[]},rules:{year:[{required:!0,message:"年份不能为空",trigger:"blur"}],cycleId:[{required:!0,message:"考核周期不能为空",trigger:"blur"}],weight:[{type:"number",min:0,max:100,message:"权重为0-100之间的数字",trigger:"blur"}]}}},created:function(){},methods:{handleRow:function(t){return row},handleSelectEmp:function(t){var e=this;t.forEach((function(t){var r={personId:t.empId,deptName:t.orgName,empName:t.empName,empNumber:t.empNumber},a=!1,n=!1;e.form.relationVOList.forEach((function(e){e.personId!=t.empId||(a=!0)})),e.form.evalPersonVOList.forEach((function(r){if(r.personId==t.empId)return e.msgError("考核人与被考核人不能为同一人"),void(n=!0)})),a||n||e.form.relationVOList.push(r)}))},handleSelectEvalPer:function(t){var e=this,r=this.form.evalPersonVOList.length+1;t.forEach((function(t){var a={personId:t.empId,empNumber:t.empNumber,empName:t.empName,orderNumber:r};r++;var n=!1,o=!1;e.form.evalPersonVOList.forEach((function(e){e.personId!=t.empId||(n=!0)})),e.form.relationVOList.forEach((function(r){if(r.personId==t.empId)return e.msgError("考核人与被考核人不能为同一人"),void(o=!0)})),n||o||e.form.evalPersonVOList.push(a)}))},deleteRow:function(t,e){e.splice(t,1)},moveUpTable:function(t,e,r){if(t>0){var a=r[t-1];a.orderNumber++,r[t].orderNumber--,r.splice(t-1,1),r.splice(t,0,a)}else this.$message({type:"onfo",message:"已经是第一条，不可上移"})},moveDownTable:function(t,e,r){if(t+1!==r.length){var a=r[t+1];a.orderNumber--,r[t].orderNumber++,r.splice(t+1,1),r.splice(t,0,a)}else this.$message({type:"onfo",message:"已经是最后一条，不可下移"})},getCycleList:function(){var t=this,e={cycleYear:this.form.year.getFullYear(),pageNum:1,pageSize:0};Object(c["listPfmcCycle"])(e).then((function(e){"0"===e.code?t.cycleOptions=e.data.list:t.msgError("查询考核周期列表失败")})).catch((function(e){t.msgError(e)}))},open:function(){var t=this;"0"!=this.relationId?Object(o["getPfmcRelation"])(this.relationId).then((function(e){"0"===e.code?(t.form=e.data,t.cycleOptions=t.form.cycleList):t.msgError(e.msg)})).catch((function(e){t.msgError(e)})):(this.form.year=this.queryYear,this.form.cycleId=this.queryCycleId,this.getCycleList())},cancel:function(){this.show=!1},reset:function(){this.resetForm("relationForm"),this.form.relationVOList=[],this.form.evalPersonVOList=[]},submitForm:function(){var t=this;this.$refs["relationForm"].validate((function(e){e&&t.validateForm()&&("0"!==t.relationId?Object(o["updatePfmcRelation"])(t.form).then((function(e){"0"===e.code?(t.msgSuccess("修改成功"),t.cancel()):t.msgError(e.msg)})):Object(o["addPfmcRelation"])(t.form).then((function(e){"0"===e.code?(t.msgSuccess("新增成功"),t.cancel()):t.msgError(e.code)})))}))},validateForm:function(){var t=0,e=0,r=!0,a=0,n="";return this.form.evalPersonVOList.forEach((function(o){return Number(o.weight)&&(a+=Number(o.weight)),1==o.scoreFlag&&t++,1==o.targetFlag&&e++,0==o.scoreFlag&&0==o.targetFlag?(r=!1,void(n="目标审核和考核打分至少勾选一个，请修改")):1==o.scoreFlag&&null==o.weight?(r=!1,n="设置为考核打分人的，权重不能为空，请修改",!1):void 0})),r?t>4||e>4?(this.msgError("目标审核和考核打分每种最多可维护4位人员，请修改"),!1):!(t>0&&100!=a)||(this.msgError("权重总和不等于100，请修改"),!1):(this.msgError(n),!1)}},watch:{show:function(){0==this.show&&this.$emit("update:visible",!1)},visible:function(){this.show=this.visible}}},i=l,s=(r("c20a"),r("2877")),u=Object(s["a"])(i,a,n,!1,null,"484a640d",null);e["default"]=u.exports},"304f":function(t,e,r){"use strict";r.r(e),r.d(e,"listPfmcCycle",(function(){return o})),r.d(e,"getPfmcCycle",(function(){return c})),r.d(e,"addPfmcCycle",(function(){return l})),r.d(e,"updatePfmcCycle",(function(){return i})),r.d(e,"batchAddPfmcCycle",(function(){return s}));var a=r("b775"),n=r("b854");function o(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/list"),method:"get",params:t})}function c(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/").concat(t),method:"get"})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/add"),method:"post",data:t})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/update"),method:"put",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmccycle/batchAdd"),method:"post",data:t})}},"4a47":function(t,e,r){"use strict";r.r(e),r.d(e,"listPfmcGroup",(function(){return o})),r.d(e,"addPfmcGroup",(function(){return c})),r.d(e,"getPfmcGroup",(function(){return l})),r.d(e,"updatePfmcGroup",(function(){return i})),r.d(e,"delPfmcGroup",(function(){return s})),r.d(e,"disablePfmcGroup",(function(){return u})),r.d(e,"changeGroupState",(function(){return p})),r.d(e,"listGroupUsers",(function(){return m}));var a=r("b775"),n=r("b854");function o(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/list"),method:"get",params:t})}function c(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup"),method:"post",data:t})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/").concat(t),method:"get"})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/update"),method:"put",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/").concat(t),method:"delete"})}function u(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/disablePfmcBaseGroup/").concat(t),method:"get"})}function p(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/changeGroupState"),method:"put",data:t})}function m(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcBaseGroup/groupUsers"),method:"get",params:t})}},"51a2":function(t,e,r){"use strict";r.r(e),r.d(e,"listProgram",(function(){return o})),r.d(e,"getProgram",(function(){return c})),r.d(e,"updateProgram",(function(){return l})),r.d(e,"updateProgramStatus",(function(){return i})),r.d(e,"addProgram",(function(){return s})),r.d(e,"delProgram",(function(){return u}));var a=r("b775"),n=r("b854");function o(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcProgram/list"),method:"get",params:t})}function c(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcProgram/")+t,method:"get"})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcProgram/update"),method:"put",data:t})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcProgram/updateStatus"),method:"put",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcProgram/add"),method:"post",data:t})}function u(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcProgram/del"),method:"put",data:t})}},"542c":function(t,e,r){},"69b5":function(t,e,r){},7514:function(t,e,r){"use strict";var a=r("5ca1"),n=r("0a49")(5),o="find",c=!0;o in[]&&Array(1)[o]((function(){c=!1})),a(a.P+a.F*c,"Array",{find:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(o)},"93eb":function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"ihr-wrapper"},[r("div",{staticClass:"top-query"},[r("el-form",{ref:"form",attrs:{model:t.queryParams,"label-width":"80px"}},[r("el-row",[r("el-col",[r("el-form-item",{attrs:{"label-width":"0px"}},[r("el-radio-group",{model:{value:t.queryParams.searchMode,callback:function(e){t.$set(t.queryParams,"searchMode",e)},expression:"queryParams.searchMode"}},[r("el-radio-button",{attrs:{label:"ORG"}},[t._v("按部门查询")]),t._v(" "),r("el-radio-button",{attrs:{label:"GROUP"}},[t._v("按考核组查询")])],1)],1)],1)],1),t._v(" "),r("el-row",[r("el-col",{attrs:{span:6}},[r("el-form-item",{attrs:{label:"年份",prop:"year",rules:{required:!0}}},[r("el-date-picker",{staticStyle:{width:"100%"},attrs:{clearable:!1,type:"year"},on:{change:t.getCycleList},model:{value:t.queryParams.year,callback:function(e){t.$set(t.queryParams,"year",e)},expression:"queryParams.year"}})],1)],1),t._v(" "),r("el-col",{attrs:{span:9}},[r("el-form-item",{attrs:{label:"考核周期",prop:"cycleId",rules:{required:!0}}},[r("el-select",{attrs:{placeholder:"选择考核期间"},on:{change:t.getGroupList},model:{value:t.queryParams.cycleId,callback:function(e){t.$set(t.queryParams,"cycleId",e)},expression:"queryParams.cycleId"}},t._l(t.cycleOptions,(function(t){return r("el-option",{key:t.cycleId,attrs:{label:t.cycleName,value:t.cycleId}})})),1)],1)],1),t._v(" "),r("el-col",{attrs:{span:9}},["ORG"===t.queryParams.searchMode?r("el-form-item",{attrs:{label:"部门",prop:"orgIds",rules:{required:!0}}},[r("tree-select",{staticClass:"dept-tree-select",attrs:{options:t.orgOptions,placeholder:"选择部门",multiple:"","default-expand-level":1},model:{value:t.queryParams.orgIds,callback:function(e){t.$set(t.queryParams,"orgIds",e)},expression:"queryParams.orgIds"}})],1):r("el-form-item",{attrs:{label:"考核组",prop:"groupIds",rules:{required:!0}}},[r("el-select",{attrs:{placeholder:"请选择",multiple:"",clearable:""},model:{value:t.queryParams.groupIds,callback:function(e){t.$set(t.queryParams,"groupIds",e)},expression:"queryParams.groupIds"}},t._l(t.groupOptions,(function(t){return r("el-option",{key:t.groupId,attrs:{label:t.groupName,value:t.groupId}})})),1)],1)],1)],1)],1),t._v(" "),r("div",[r("el-button",{attrs:{type:"primary",name:"ORG"===t.queryParams.searchMode?"handleQueryByOrg":"handleQueryByGroup",icon:"el-icon-search"},on:{click:function(e){return t.handleQuery()}}},[t._v("查询")])],1)],1),t._v(" "),r("div",{staticClass:"main-table"},[r("div",{staticClass:"button-flex"},[r("el-select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择考核方案"},model:{value:t.curProgramId,callback:function(e){t.curProgramId=e},expression:"curProgramId"}},t._l(t.programList,(function(t){return r("el-option",{key:t.programId,attrs:{label:t.programName,value:t.programId}})})),1),t._v(" "),r("set-fixed-dialog",{attrs:{title:t.title,"prog-id":t.curProgramId,"fixed-progrel":t.fixedProgRel},on:{handleSave:t.handleSave}}),t._v(" "),r("el-button",{attrs:{type:"primary",icon:"el-icon-caret-right",disabled:0===t.selectedEmpList.length},on:{click:t.startPlan}},[t._v("启动计划")])],1),t._v(" "),r("el-tabs",{attrs:{type:"border-card"}},[r("el-tab-pane",{attrs:{label:"查询结果"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"searchTabel",attrs:{data:t.searchEmpList,"row-key":"empId","select-on-indeterminate":!1},on:{"select-all":t.selsAll,select:t.trigSelect}},[r("el-table-column",{attrs:{type:"selection",selectable:t.selectAble}}),t._v(" "),r("el-table-column",{attrs:{label:"员工编号",prop:"empNumber","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"empName","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"部门",prop:"orgName","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"职位",prop:"positionName","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"目标审核人",prop:"planEvalMan",width:"300"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.planEvalMan?[r("div",[t._v("\n            "+t._s(e.row.planEvalMan)+"\n            "),r("el-button",{attrs:{type:"primary",plain:"",circle:"",size:"mini",icon:"el-icon-edit"},on:{click:function(r){return t.handleModifyEvalMan(e.row)}}})],1)]:void 0}}],null,!0)}),t._v(" "),r("el-table-column",{attrs:{label:"计划状态",prop:"planStatus",formatter:t.formTypeFormat,"show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"不参加考核原因",prop:"noevalReason",width:"120","show-overflow-tooltip":""}})],1),t._v(" "),r("pagination",{directives:[{name:"show",rawName:"v-show",value:t.total>0,expression:"total>0"}],attrs:{total:t.total,page:t.queryParams.pageNum,limit:t.queryParams.pageSize},on:{"update:page":function(e){return t.$set(t.queryParams,"pageNum",e)},"update:limit":function(e){return t.$set(t.queryParams,"pageSize",e)},pagination:t.getList}})],1),t._v(" "),r("el-tab-pane",{attrs:{label:"已选中员工"+t.selectedEmpList.length+"人"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.selectedEmpList}},[r("el-table-column",{attrs:{label:"员工编号",prop:"empNumber","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"姓名",prop:"empName","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"部门",prop:"orgName","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"职位",prop:"positionName","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"目标审核人",prop:"planEvalMan",width:"300","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"计划状态",prop:"planStatus",formatter:t.formTypeFormat,"show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"不参加考核原因",prop:"noevalReason",width:"120","show-overflow-tooltip":""}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"90",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text"},on:{click:function(r){return t.handleClearSel(e.row)}}},[t._v("删除")])]}}])})],1)],1)],1)],1),t._v(" "),r("view-edit-dialog",{attrs:{visible:t.open,title:t.title,"relation-id":t.relationId,"is-update":t.isUpdate,queryYear:t.queryParams.year},on:{"update:visible":function(e){t.open=e}}})],1)},n=[],o=(r("5df3"),r("f400"),r("ac6a"),r("7514"),r("a5fd")),c=r("4a47"),l=r("2879"),i=r("51a2"),s=r("304f"),u=(r("542c"),r("2dd3")),p={components:{TreeSelect:function(){return r.e("chunk-5c5c1f08").then(r.t.bind(null,"7026",7))},ImportData:function(){return r.e("chunk-a7c7fc38").then(r.bind(null,"77dc"))},ExportData:function(){return r.e("chunk-336f6cc4").then(r.bind(null,"2ee5"))},viewEditDialog:u["default"],setFixedDialog:function(){return r.e("chunk-5bb17500").then(r.bind(null,"9494"))}},data:function(){return{loading:!1,total:0,searchEmpList:[],orgOptions:void 0,relationId:void 0,isUpdate:!1,title:"",open:!1,isEdit:!0,groupPeriodTypeOptions:[],cycleOptions:[],groupOptions:[],isOpenOptions:[],searchType:void 0,programList:[],empIds:"",fixedProgRel:{},selectedEmpList:[],currPagePreSelected:[],prePageSelected:[],curProgramId:void 0,filterMethod:function(t,e){return e.nickName.indexOf(t)>-1},queryParams:{pageNum:1,pageSize:10,year:new Date,cycleId:void 0,orgIds:[],groupIds:[],searchMode:"ORG",empName:void 0,empNumber:void 0},form:{},rules:{}}},created:function(){this.getTreeselect(),this.getGroupList(),this.getCycleList(),this.getProgramList()},methods:{handleReset:function(){this.queryParams={pageNum:1,pageSize:10,year:new Date,cycleId:void 0,searchMode:"ORG",orgIds:[],groupIds:[],empName:void 0,empNumber:void 0}},handleSave:function(t){this.fixedProgRel=t},getProgramList:function(){var t=this,e={programName:"",status:"1",pageNum:1,pageSize:0};Object(i["listProgram"])(e).then((function(e){"0"===e.code?t.programList=e.data.list:t.msgError("查询绩效考核方案列表失败")})).catch((function(e){t.msgError(e)}))},getCycleList:function(){var t=this;this.queryParams.cycleId="";var e={cycleYear:this.queryParams.year.getFullYear(),pageNum:1,pageSize:0};Object(s["listPfmcCycle"])(e).then((function(e){"0"===e.code?t.cycleOptions=e.data.list:t.msgError("查询考核周期列表失败")})).catch((function(e){t.msgError(e)}))},getGroupList:function(){var t=this;if(this.queryParams.cycleId){this.queryParams.groupIds=[];var e=this.cycleOptions.find((function(e){return e.cycleId==t.queryParams.cycleId})),r={groupPeriodType:e?e.cycleType:"",groupState:1,pageNum:1,pageSize:0};Object(c["listPfmcGroup"])(r).then((function(e){"0"===e.code?t.groupOptions=e.data.list:t.msgError("查询考核组列表失败")})).catch((function(e){t.msgError(e)}))}},formTypeFormat:function(t,e,r,a){return"PLAN_CREATED"===r?"计划制定":"PLAN_FINISHED"===r?"计划完成":"EVAL_CREATED"===r?"未发起考核":"SELF_EVALUATE"===r?"自评打分":"MAN_AUDITEVAL"===r?"领导审核":"EVAL_FINISHED"===r?"考核完成":"未发起"},getSelectedUser:function(t){this.selectedRows=[];for(var e=0;e<t.length;e++){var r=t[e];r.noevalReason?this.$refs.searchTabel.toggleRowSelection(r):(this.selectedRows.push(r),this.selectedEmpList.push(r))}},getList:function(){"ORG"===this.queryParams.searchMode?this.handleQueryByOrg():this.handleQueryByGroup()},searchValid:function(){return this.queryParams.cycleId?0!=this.queryParams.orgIds.length||0!=this.queryParams.groupIds.length||(this.msgError("请先选择部门 或者 考核组!"),!1):(this.msgError("请先选择考核期间!"),!1)},handleQueryByOrg:function(){var t=this;this.searchValid()&&(this.loading=!0,Object(o["listPfmcEmpByOrgList"])(this.queryParams).then((function(e){t.searchEmpList=e.data.list,t.total=e.data.total,t.$nextTick((function(){var t=this;this.currPagePreSelected=[],this.searchEmpList.forEach((function(e,r){t.selectedEmpList.forEach((function(r,a){e.empId===r.empId&&(t.currPagePreSelected.push(e),t.$refs.searchTabel.toggleRowSelection(e,!0))}))}))})),t.loading=!1})))},selsAll:function(t){var e=this,r=[],a=[];t.forEach((function(t){"undefined"===typeof t.noevalReason?r.push(t):a.push(t)})),a.forEach((function(t){return e.$refs.searchTabel.toggleRowSelection(t,!1)})),this.selsChange(r)},trigSelect:function(t,e){this.selsChange(t,[e])},selsChange:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];t.length>this.currPagePreSelected.length?this.selectedEmpList=this.addSels(this.selectedEmpList,t):t.length>0&&0!==e.length?this.selectedEmpList=this.delUnSels(this.selectedEmpList,e):0===t.length&&(this.selectedEmpList=this.delUnSels(this.selectedEmpList,this.currPagePreSelected)),this.currPagePreSelected=t},addSels:function(t,e){var r=t.concat(e),a=new Map;r.forEach((function(t){return a.set(t.empId,t)}));var n=new Array;return a.forEach((function(t,e){n.push(t)})),n},delUnSels:function(t,e){return e.forEach((function(e,r){t.forEach((function(r,a){e.empId===r.empId&&t.splice(a,1)}))})),t},selectAble:function(t,e){return!t.planStatus&&!t.noevalReason},handleQueryByGroup:function(){var t=this;this.searchValid()&&(this.loading=!0,Object(o["listPfmcEmpByGroupList"])(this.queryParams).then((function(e){t.searchEmpList=e.data.list,t.total=e.data.total,t.$nextTick((function(){var t=this;this.currPagePreSelected=[],this.searchEmpList.forEach((function(e,r){t.selectedEmpList.forEach((function(r,a){e.empId===r.empId&&(t.currPagePreSelected.push(e),t.$refs.searchTabel.toggleRowSelection(e,!0))}))}))})),t.loading=!1})))},getTreeselect:function(){var t=this;Object(l["treeselect"])().then((function(e){e.data.forEach((function(t,e){t.id=t.orgId})),t.orgOptions=e.data}))},cancel:function(){this.open=!1,this.reset()},reset:function(){this.resetForm("form")},handleQuery:function(){this.queryParams.pageNum=1,this.getList()},handleModifyEvalMan:function(t){this.relationId=t.relationId,this.open=!0,this.isUpdate=!0,this.title="修改考核关系"},handleClearSel:function(t){var e=this;this.selectedEmpList.forEach((function(r,a){r.empId===t.empId&&e.selectedEmpList.splice(a,1)})),this.searchEmpList.forEach((function(r,a){r.empId===t.empId&&e.$refs.searchTabel.toggleRowSelection(t,!1)}))},startPlan:function(){for(var t=this,e="",r=0;r<this.selectedEmpList.length;r++){var a=this.selectedEmpList[r];if(a.planStatus)return void this.msgError(a.empName+"的计划已发起，请勿重复发起！");if(a.noevalReason)return void this.msgError(a.empName+"不参加该周期的考核！");e=0===r?a.empId:e+","+a.empId}if(this.queryParams.cycleId)if(this.curProgramId){var n={periodId:this.queryParams.cycleId,moduleId:this.curProgramId,empIds:e,pfmcFixedProgRel:this.fixedProgRel};Object(o["startEmpPlan"])(n).then((function(e){"0"===e.code?(t.msgSuccess("发起成功,请重新查询"),setTimeout(t.getList,1e3)):t.msgError(e.msg)}))}else this.msgError("请先选择考核模板");else this.msgError("请先选择考核期间")}},watch:{open:function(){0==this.open&&this.getList()}}},m=p,d=(r("e49d"),r("2877")),f=Object(d["a"])(m,a,n,!1,null,"3a010f66",null);e["default"]=f.exports},a5fd:function(t,e,r){"use strict";r.r(e),r.d(e,"listPfmcEmpByOrgList",(function(){return o})),r.d(e,"listPfmcEmpByGroupList",(function(){return c})),r.d(e,"getFixedProgRelByProgId",(function(){return l})),r.d(e,"addFixedProgRel",(function(){return i})),r.d(e,"startEmpPlan",(function(){return s}));var a=r("b775"),n=r("b854");function o(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/pfmcStartPlan/getPfmcEmpByOrgList"),method:"post",data:t})}function c(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/pfmcStartPlan/getPfmcEmpByGroupList"),method:"post",data:t})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/pfmcStartPlan/getFixedProgRel/").concat(t),method:"get"})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/pfmcStartPlan"),method:"post",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcExecution"],"/pfmcStartPlan/startEmpPlan"),method:"post",data:t})}},b854:function(t,e,r){"use strict";r.r(e),r.d(e,"pfmcSettings",(function(){return a})),r.d(e,"pfmcAsist",(function(){return n})),r.d(e,"pfmcExecution",(function(){return o})),r.d(e,"pfmcEval",(function(){return c}));var a="pfmc-settings",n="pfmc-asist",o="pfmc-execution",c="pfmc-eval"},c20a:function(t,e,r){"use strict";var a=r("07ec"),n=r.n(a);n.a},e31f:function(t,e,r){"use strict";r.r(e),r.d(e,"listPfmcRelation",(function(){return o})),r.d(e,"getPfmcRelation",(function(){return c})),r.d(e,"addPfmcRelation",(function(){return l})),r.d(e,"updatePfmcRelation",(function(){return i})),r.d(e,"deletePfmcRelation",(function(){return s})),r.d(e,"batchDelRelation",(function(){return u})),r.d(e,"batchAddPfmcRelation",(function(){return p})),r.d(e,"recordCopyRelation",(function(){return m})),r.d(e,"noRecordCopyRelation",(function(){return d}));var a=r("b775"),n=r("b854");function o(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/list"),method:"post",data:t})}function c(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/").concat(t),method:"get"})}function l(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/add"),method:"post",data:t})}function i(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/update"),method:"put",data:t})}function s(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/delete"),method:"put",data:t})}function u(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/batchdel"),method:"put",data:t})}function p(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/batchAdd"),method:"post",data:t})}function m(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/recordCopy"),method:"post",data:t})}function d(t){return Object(a["a"])({url:"".concat(n["pfmcSettings"],"/pfmcrelation/noRecordCopy"),method:"post",data:t})}},e49d:function(t,e,r){"use strict";var a=r("69b5"),n=r.n(a);n.a},f400:function(t,e,r){"use strict";var a=r("c26b"),n=r("b39a"),o="Map";t.exports=r("e0b8")(o,(function(t){return function(){return t(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(t){var e=a.getEntry(n(this,o),t);return e&&e.v},set:function(t,e){return a.def(n(this,o),0===t?0:t,e)}},a,!0)}}]);