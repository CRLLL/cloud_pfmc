(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-788297f1","chunk-2d21062b","chunk-6b5aca3b","chunk-2d21062b"],{a94c:function(e,t,l){"use strict";l.r(t),l.d(t,"listLevel",(function(){return o})),l.d(t,"levelScoreList",(function(){return n})),l.d(t,"addLevel",(function(){return r})),l.d(t,"updateLevel",(function(){return s})),l.d(t,"delLevel",(function(){return c})),l.d(t,"disablePfmcLevel",(function(){return u})),l.d(t,"changeLevelState",(function(){return d})),l.d(t,"listLevelScoreByProgramId",(function(){return v}));var i=l("b775"),a=l("b854");function o(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel/list"),method:"get",params:e})}function n(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel/").concat(e),method:"get"})}function r(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel"),method:"post",data:e})}function s(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel/update"),method:"put",data:e})}function c(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel/").concat(e),method:"delete"})}function u(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel/disablePfmcLevel/").concat(e),method:"get"})}function d(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel/changeLevelState"),method:"put",data:e})}function v(e){return Object(i["a"])({url:"".concat(a["pfmcSettings"],"/pfmcPresetLevel/listLevelScoreByProgramId/").concat(e),method:"get"})}},b854:function(e,t,l){"use strict";l.r(t),l.d(t,"pfmcSettings",(function(){return i})),l.d(t,"pfmcAsist",(function(){return a})),l.d(t,"pfmcExecution",(function(){return o})),l.d(t,"pfmcEval",(function(){return n}));var i="pfmc-settings",a="pfmc-asist",o="pfmc-execution",n="pfmc-eval"},fcd0:function(e,t,l){"use strict";l.r(t);var i=function(){var e=this,t=e.$createElement,l=e._self._c||t;return l("div",{staticClass:"ihr-wrapper"},[l("div",{staticClass:"top-query"},[l("el-form",{ref:"queryForm",attrs:{model:e.queryParams,"label-width":"110px"}},[l("el-row",[l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"等级定义名称"}},[l("el-input",{attrs:{placeholder:"请输入...",clearable:""},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleQuery(t)}},model:{value:e.queryParams.levelName,callback:function(t){e.$set(e.queryParams,"levelName",t)},expression:"queryParams.levelName"}})],1)],1),e._v(" "),l("el-col",{attrs:{span:8}},[l("el-form-item",{attrs:{label:"状态"}},[l("el-select",{attrs:{placeholder:"全部",clearable:""},model:{value:e.queryParams.levelState,callback:function(t){e.$set(e.queryParams,"levelState",t)},expression:"queryParams.levelState"}},e._l(e.stateOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)],1)],1)],1)],1),e._v(" "),l("div",[l("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleQuery}},[e._v("查询")]),e._v(" "),l("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-refresh-left"},on:{click:e.handleReset}},[e._v("重置")])],1)],1),e._v(" "),l("div",{staticClass:"main-table"},[l("div",{staticClass:"button-flex"},[l("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("新增")])],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.levelList,"row-key":"levelId"}},[l("el-table-column",{attrs:{label:"序号",type:"index"}}),e._v(" "),l("el-table-column",{attrs:{prop:"levelName",label:"等级定义名称","show-overflow-tooltip":!0}}),e._v(" "),l("el-table-column",{attrs:{prop:"levelContent",label:"等级","show-overflow-tooltip":!0}}),e._v(" "),l("el-table-column",{attrs:{label:"状态",prop:"levelStateView"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-switch",{attrs:{"active-value":"1","inactive-value":"0"},on:{change:function(l){return e.handleUpdateState(t.row)}},model:{value:t.row.levelStateView,callback:function(l){e.$set(t.row,"levelStateView",l)},expression:"scope.row.levelStateView"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-button",{attrs:{type:"text"},on:{click:function(l){return e.handleView(t.row)}}},[e._v("查看")]),e._v(" "),0===t.row.refCount?l("el-button",{attrs:{type:"text"},on:{click:function(l){return e.handleUpdate(t.row)}}},[e._v("编辑")]):e._e(),e._v(" "),0===t.row.refCount?l("el-popconfirm",{staticClass:"el-button-confirm",attrs:{title:"您确定要删除吗？"},on:{onConfirm:function(l){return e.handleDelete(t.row)}}},[l("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[e._v("删除")])],1):e._e()]}}])})],1),e._v(" "),l("pagination",{directives:[{name:"show",rawName:"v-show",value:e.total>0,expression:"total>0"}],staticClass:"pagination-wrap",attrs:{total:e.total,page:e.queryParams.pageNum,limit:e.queryParams.pageSize},on:{"update:page":function(t){return e.$set(e.queryParams,"pageNum",t)},"update:limit":function(t){return e.$set(e.queryParams,"pageSize",t)},pagination:e.getList}})],1),e._v(" "),l("el-dialog",{attrs:{title:e.title,visible:e.open,width:"680px"},on:{"update:visible":function(t){e.open=t}}},[l("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,inline:!0}},[l("el-form-item",{attrs:{label:"等级定义名称",prop:"levelName","label-width":"110px"}},[l("el-input",{attrs:{placeholder:"请输入等级定义名称",clearable:"",size:"small",disabled:!e.isEdit},on:{input:function(t){return e.change(t)}},model:{value:e.form.levelName,callback:function(t){e.$set(e.form,"levelName",t)},expression:"form.levelName"}})],1),e._v(" "),l("el-form-item",{attrs:{label:"状态",prop:"levelState","label-width":"80px"}},[l("el-select",{attrs:{placeholder:"状态",clearable:"",size:"small"},on:{input:function(t){return e.change(t)}},model:{value:e.form.levelState,callback:function(t){e.$set(e.form,"levelState",t)},expression:"form.levelState"}},e._l(e.stateOptions,(function(t){return l("el-option",{key:t.dictValue,attrs:{label:t.dictLabel,value:t.dictValue,disabled:!e.isEdit}})})),1)],1),e._v(" "),l("el-form-item",{attrs:{label:"公开",prop:"isPublic","label-width":"110px"}},[l("el-radio-group",{attrs:{disabled:!e.isEdit},model:{value:e.form.isPublic,callback:function(t){e.$set(e.form,"isPublic",t)},expression:"form.isPublic"}},[l("el-radio",{attrs:{label:"Y"}},[e._v("是")]),e._v(" "),l("el-radio",{attrs:{label:"N"}},[e._v("否")])],1)],1),e._v(" "),l("el-form-item",{attrs:{label:" ","label-width":"280px"}},[e.isEdit?l("el-button",{attrs:{type:"primary",plain:"",icon:"el-icon-plus",size:"mini"},on:{click:e.handleAddRow}},[e._v("添加行")]):e._e()],1),e._v(" "),l("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{data:e.levelScoreList,"row-key":"levelScoreId","tree-props":{children:"children",hasChildren:"hasChildren"}}},[l("el-table-column",{attrs:{label:"等级","show-overflow-tooltip":!0,width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-input",{attrs:{width:"100px",disabled:!e.isEdit},model:{value:t.row.level,callback:function(l){e.$set(t.row,"level",l)},expression:"scope.row.level"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"下限比较符","show-overflow-tooltip":!0,width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{placeholder:"不限制",clearable:"",size:"small",disabled:!e.isEdit},model:{value:t.row.lowLimitFlag,callback:function(l){e.$set(t.row,"lowLimitFlag",l)},expression:"scope.row.lowLimitFlag"}},e._l(e.levelFlagOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"评分下限","show-overflow-tooltip":!0,width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-input",{attrs:{width:"90px",disabled:!e.isEdit},model:{value:t.row.levelLowLimit,callback:function(l){e.$set(t.row,"levelLowLimit",l)},expression:"scope.row.levelLowLimit"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"上限比较符","show-overflow-tooltip":!0,width:"120px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-select",{attrs:{placeholder:"不限制",clearable:"",size:"small",disabled:!e.isEdit},model:{value:t.row.highLimitFlag,callback:function(l){e.$set(t.row,"highLimitFlag",l)},expression:"scope.row.highLimitFlag"}},e._l(e.levelFlagOptions,(function(e){return l("el-option",{key:e.dictValue,attrs:{label:e.dictLabel,value:e.dictValue}})})),1)]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"评分上限","show-overflow-tooltip":!0,width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-input",{attrs:{width:"90px",disabled:!e.isEdit},model:{value:t.row.levelHighLimit,callback:function(l){e.$set(t.row,"levelHighLimit",l)},expression:"scope.row.levelHighLimit"}})]}}])}),e._v(" "),l("el-table-column",{attrs:{label:"等级描述","show-overflow-tooltip":!0,width:"80px"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-input",{attrs:{width:"90px",disabled:!e.isEdit},model:{value:t.row.levelRemark,callback:function(l){e.$set(t.row,"levelRemark",l)},expression:"scope.row.levelRemark"}})]}}])}),e._v(" "),e.isEdit?l("el-table-column",{attrs:{label:"操作",align:"center",width:"80","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(t){return[l("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"删除",placement:"top",enterable:!1}},[l("el-button",{directives:[{name:"hasPermi",rawName:"v-hasPermi",value:["system:menu:remove"],expression:"['system:menu:remove']"}],attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(l){return e.handleDelRow(t.$index,t.row)}}})],1)]}}],null,!1,439567308)}):e._e()],1)],1),e._v(" "),e.isEdit?l("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[l("el-button",{attrs:{plan:"",icon:"el-icon-close"},on:{click:e.cancel}},[e._v("取消")]),e._v(" "),l("el-button",{attrs:{type:"primary",icon:"el-icon-bank-card"},on:{click:e.submitForm}},[e._v("保存")])],1):e._e()],1)],1)},a=[],o=l("bd86"),n=l("a94c"),r=(l("7026"),l("542c"),l("5aee"),{components:{},data:function(){return{loading:!0,total:0,levelList:[],levelScoreList:[],title:"",open:!1,isEdit:!0,stateOptions:[],levelFlagOptions:[],queryParams:{pageNum:1,pageSize:10,levelName:void 0,levelState:"1"},form:{levelName:void 0,levelState:"1",isPublic:"Y"},rules:{levelName:[{required:!0,message:"请输入等级定义名称",trigger:"blur"},{min:1,max:30,message:"长度在 1到 30 个字符",trigger:"blur"}]}}},created:function(){var e=this;this.getDicts("sys_normal_status").then((function(t){e.stateOptions=t.data})),this.getDicts("pfmc_level_flag").then((function(t){e.levelFlagOptions=t.data})),this.getList()},methods:{handleAddRow:function(){var e={level:"",lowLimitFlag:"",levelLowLimit:"",highLimitFlag:"",levelHighLimit:"",levelRemark:""};this.levelScoreList.push(e)},handleReset:function(){this.queryParams={pageNum:1,pageSize:10,levelName:void 0,levelState:"1"}},handleDelRow:function(e,t){this.levelScoreList.splice(e,1)},change:function(e){this.$forceUpdate()},getList:function(){var e=this;this.loading=!0,Object(n["listLevel"])(this.queryParams).then((function(t){e.levelList=t.data.list,e.total=t.data.total,e.loading=!1}))},cancel:function(){this.open=!1},handleQuery:function(){this.queryParams.page=1,this.getList()},reset:function(){var e;this.form=(e={levelId:void 0,levelName:void 0,levelState:void 0,levelScoreList:void 0},Object(o["a"])(e,"levelState","1"),Object(o["a"])(e,"isPublic","Y"),e),this.levelScoreList=[],this.resetForm("form")},handleView:function(e){var t=this;this.levelScoreList=null,this.form.levelId=e.levelId,this.form.levelName=e.levelName,this.form.levelState=e.levelState?"1":"0",Object(n["levelScoreList"])(e.levelId).then((function(e){t.levelScoreList=e.data,t.open=!0,t.isEdit=!1,t.title="修改等级"}))},handleUpdate:function(e){var t=this;this.levelScoreList=null,this.form.levelId=e.levelId,this.form.levelName=e.levelName,this.form.levelState=e.levelState?"1":"0",Object(n["levelScoreList"])(e.levelId).then((function(e){t.levelScoreList=e.data,t.open=!0,t.title="修改等级",t.isEdit=!0}))},handleAdd:function(e){this.reset(),this.open=!0,this.title="新增等级信息定义"},validation:function(){for(var e=0;e<this.levelScoreList.length;e++){var t=this.levelScoreList[e],l=/^([1-9][0-9]*(\.\d{1,2})?)|(0\.\d{1,2})$/;if(!t.level)return this.msgError("请输入等级信息！"),!1;if(!l.test(t.levelLowLimit)&&0!=t.levelLowLimit)return this.msgError("请输入正确的等级下限！"),!1;if(!l.test(t.levelHighLimit)&&0!=t.levelLowLimit)return this.msgError("请输入正确的等级上限！"),!1}return!0},submitForm:function(){var e=this;this.validation()&&this.$refs["form"].validate((function(t){t&&(e.form.levelState="1"==e.form.levelState?"true":"false",e.form.levelScoreList=e.levelScoreList,e.form.isDeleted="false",void 0!==e.form.levelId?Object(n["updateLevel"])(e.form).then((function(t){"0"===t.code?(e.msgSuccess("修改成功"),e.open=!1,e.getList()):e.msgError(t.msg)})):Object(n["addLevel"])(e.form).then((function(t){"0"===t.code?(e.msgSuccess("新增成功"),e.open=!1,e.getList()):e.msgError(t.msg)})))}))},handledisAble:function(e){var t=this;this.$confirm('是否设置名称为"'+e.levelName+'"的数据项为失效?',"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return Object(n["disablePfmcLevel"])(e.levelId)})).then((function(e){console.log("disablePfmcLevel",e),"0"===e.code?(t.getList(),t.msgSuccess("设置成功")):t.msgError(e.msg)})).catch((function(){}))},handleUpdateState:function(e){var t=this;this.$confirm('您确定要将名称为"'+e.levelName+'"的等级设置为'+("1"===e.levelStateView?"有效":"失效")+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.loading=!0;var l=e.levelId,i=e.levelStateView,a={levelId:l,levelStateView:i};Object(n["changeLevelState"])(a).then((function(e){t.loading=!1,"0"===e.code?(t.msgSuccess("修改成功"),t.getList()):t.msgError(e.msg)})).catch((function(e){t.loading=!1,t.msgError(e)}))})).catch((function(){e.levelStateView="1"===e.levelStateView?"0":"1"}))},handleDelete:function(e){var t=this;this.loading=!0,Object(n["delLevel"])(e.levelId).then((function(e){t.loading=!1,console.log("delLevel",e),"0"===e.code?(t.getList(),t.msgSuccess("删除成功")):t.msgError(e.msg)})).catch((function(e){t.loading=!1,t.msgError(e)}))}}}),s=r,c=l("2877"),u=Object(c["a"])(s,i,a,!1,null,null,null);t["default"]=u.exports}}]);